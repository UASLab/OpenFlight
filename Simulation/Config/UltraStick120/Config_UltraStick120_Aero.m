function Aero = Config_UltraStick120_Aero(Sim, T_S2SB)
% Remarks:
% ALL stability derivative units are radians.
% Forces are defined in the Wind frame, Moments in the Body frame

switch lower(Sim.type)
    case {'openvsp', 'openvsp_v1'}
        Aero = US120_OpenVSP_v1();
    case {'nasa', 'old', 'faser'}
        Aero = US120_faser_v1();
    otherwise
        
end

% Transform S frame to SB frame
Aero.rAero_SB_m = T_S2SB * Aero.rAero_S_m;

end

function Aero = US120_faser_v1()
%% Geometric Parameters
% Aerodynamic center is Origin of the Aero Frame (force application point)
Aero.rAero_S_m = [0.32, 0, 0.072]; % approximate AMM 10/29/11
Aero.T_Aero2W = [-1, 0, 0; 0, 1, 0; 0, 0, -1]; % Rotation Transform from Aero Frame to Wind Frame

% Mean aerodynamic chord [m]
Aero.c = 0.433578; % 0.4279 m (calculated MAC)

% Wing span [m]
Aero.b = 1.917192; % 1.92 m aft max

% Wing area [m^2]
Aero.S = 0.769237171; %.7732 from measurements

% Wing Aspect Ratio [m^2]
Aero.AR = Aero.b^2 / Aero.S;

%% Aero Model Conditions
AC.Aero = load('UltraStick120_Aero');
AC.Aero.AsymmetryOn = 0; % set to 1 to turn on asymmetric aero model.

end


function Aero = US120_OpenVSP_v1()
% First Version of the OpenVSP US120 model. No body has been implimented. Viscous Drag ??

% Geometric
% Aerodynamic center is Origin of the Aero Frame (force application point)
Aero.rAero_S_m = [0.410228, 0, 0.079727];
Aero.T_Aero2W = [-1, 0, 0; 0, 1, 0; 0, 0, -1]; % Rotation Transform from Aero Frame to Wind Frame

% Mean aerodynamic chord [m]
Aero.c = 0.355882;
% Wing span [m]
Aero.b = 1.9177;
% Wing area [m^2]
Aero.S = 0.773735;
% Wing Aspect Ratio [m^2]
Aero.AR = Aero.b^2 / Aero.S;

%% Aero Model Conditions
Aero.densRef_kgpm3 = 1.225;

% Breakpoint Definitions
Aero.velBkPts = [11.9 17];
Aero.alphaBkPts = [0 1 2 3];
Aero.betaBkPts = [-5 0 5];

Aero.breakPts = {Aero.velBkPts, Aero.alphaBkPts, Aero.betaBkPts};
Aero.breakDesc = {'velocity_mps', 'alpha_rad', 'beta_rad'};

sizeArray = [length(Aero.velBkPts), length(Aero.alphaBkPts), length(Aero.betaBkPts)];

% Flow Conditions
Aero.vel = [11.9 11.9 17 11.9 17 17 11.9 17 11.9 17 17 11.9 17 11.9 11.9 17 11.9 17 11.9 11.9 17 11.9 17 17]; Aero.vel = reshape(Aero.vel, sizeArray);
Aero.Mach = [0.035 0.035 0.05 0.035 0.05 0.05 0.035 0.05 0.035 0.05 0.05 0.035 0.05 0.035 0.035 0.05 0.035 0.05 0.035 0.035 0.05 0.035 0.05 0.05]; Aero.Mach = reshape(Aero.Mach, sizeArray);
Aero.alpha = [0 3 2 1 0 3 2 1 1 0 3 2 1 0 3 2 2 1 0 3 2 1 0 3]; Aero.alpha = reshape(Aero.alpha, sizeArray);
Aero.beta = [-5 -5 -5 0 0 0 5 5 -5 -5 -5 0 0 5 5 5 -5 -5 0 0 0 5 5 5]; Aero.beta = reshape(Aero.beta, sizeArray);
Aero.rNPx_S_m = [0.3986064 0.4375814 0.4239481 0.4042551 0.3952845 0.4285298 0.4233727 0.4107394 0.4101878 0.398837 0.4397209 0.4147948 0.4045401 0.3984531 0.4371437 0.4244559 0.422869 0.4106712 0.395234 0.4271185 0.4154851 0.410247 0.3986763 0.4392591]; Aero.rNPx_S_m = reshape(Aero.rNPx_S_m, sizeArray);
Aero.loadFact = [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]; Aero.loadFact = reshape(Aero.loadFact, sizeArray);

Aero.alphaDot = zeros(size(Aero.alpha));
Aero.betaDot = zeros(size(Aero.beta));

% Trim Conditions
Aero.dailR = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.dailR = reshape(Aero.dailR, sizeArray);
Aero.dailL = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.dailL = reshape(Aero.dailL, sizeArray);
Aero.drud = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.drud = reshape(Aero.drud, sizeArray);
Aero.dflapR = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.dflapR = reshape(Aero.dflapR, sizeArray);
Aero.dflapL = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.dflapL = reshape(Aero.dflapL, sizeArray);
Aero.delev = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.delev = reshape(Aero.delev, sizeArray);
Aero.pHat = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.pHat = reshape(Aero.pHat, sizeArray);
Aero.qHat = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.qHat = reshape(Aero.qHat, sizeArray);
Aero.rHat = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.rHat = reshape(Aero.rHat, sizeArray);

%% Aero Table Setup
% Stability Table Fields, Sequence must match Simulink Model
Aero.stabFields = {'zero', 'alpha', 'beta', 'alphaDot', 'betaDot', 'pHat', 'qHat', 'rHat'};
Aero.stabDragFields = {'vis', 'osw'};

% Control Surfaces, Sequence must match that defined in Effector Subsystem
Aero.cntrlFields = {'delev', 'drud', 'dailL', 'dailR', 'dflapL', 'dflapR'};

% Dimension of the result of the table lookup
Aero.tableDim = length(Aero.breakPts) + 1;


%% Lift coefficient
Aero.CL.tot = [-0.0017456 -0.0017476 0.0824404 0.0825123 0.169081 0.169281 0.2574736 0.2578891 0 0 0.0849845 0.0850383 0.1713377 0.1714992 0.2592856 0.2596263 -0.0017515 -0.0017534 0.082375 0.0824466 0.1690226 0.1692234 0.2575531 0.2579697]; Aero.CL.tot = reshape(Aero.CL.tot, sizeArray);
Aero.CL.zero = [-9.13472216088983 -9.1329087268916 -13.8057142027998 -13.4009518764648 -19.5306942748563 -21.2767834641561 -28.6598158364169 -26.7826586081241 -7.32487952450639 -7.34330108608059 -9.94011060039619 -10.3447697045295 -15.7411332702017 -16.7490537153931 -23.9672054824522 -27.276408076006 -4.90340181808856 -3.95304623940974 -8.74402113164927 -9.36036584040026 -17.318169098729 -18.731392414356 -25.8386557960519 -22.8405598417464]; Aero.CL.zero = reshape(Aero.CL.zero, sizeArray);
Aero.CL.dailR = [0.3778004 0.378053 0.396473 0.3969703 0.3973107 0.3981149 0.40303 0.4042097 0.4003629 0.4004134 0.4036396 0.4041157 0.4059136 0.4066635 0.4099398 0.4109949 0.3859246 0.3861938 0.3981218 0.3986906 0.4068762 0.4077028 0.4026556 0.4037703]; Aero.CL.dailR = reshape(Aero.CL.dailR, sizeArray);
Aero.CL.dailL = [0.3884776 0.3887551 0.4002144 0.4007651 0.4060618 0.4069105 0.4180425 0.4192431 0.4003021 0.4005108 0.4024263 0.4029071 0.4036171 0.404361 0.4050184 0.4060625 0.381687 0.3819348 0.3985271 0.3990911 0.3993226 0.4001112 0.3971304 0.3982355]; Aero.CL.dailL = reshape(Aero.CL.dailL, sizeArray);
Aero.CL.drud = [-0.0146255 -0.0146581 -0.0220453 -0.0219356 -0.013402 -0.0131646 -0.0095925 -0.0091899 -0.0006325 -0.0006324 -0.0054168 -0.0053958 -0.0050401 -0.0050789 -0.0080472 -0.0080962 0.0138575 0.013869 0.0162796 0.0162703 0.013794 0.0135663 0.0098445 0.0094131]; Aero.CL.drud = reshape(Aero.CL.drud, sizeArray);
Aero.CL.dflapR = [0.5246908 0.5247115 0.5434686 0.543255 0.5348699 0.5340784 0.5237156 0.5217804 0.5260869 0.5261479 0.5185887 0.5187895 0.5142258 0.5142304 0.5122618 0.5118691 0.4575465 0.4571845 0.4923815 0.4924247 0.4879208 0.4880316 0.4837788 0.4836683]; Aero.CL.dflapR = reshape(Aero.CL.dflapR, sizeArray);
Aero.CL.dflapL = [0.4571763 0.4568164 0.4816889 0.4816764 0.4780055 0.4780103 0.4821374 0.4820072 0.5235094 0.5236925 0.5099904 0.5101917 0.5106736 0.5106355 0.5090635 0.508616 0.5336424 0.5336582 0.5474484 0.5472305 0.5362462 0.5354097 0.5151799 0.5131185]; Aero.CL.dflapL = reshape(Aero.CL.dflapL, sizeArray);
Aero.CL.delev = [0.5741748 0.5748669 0.587779 0.5887962 0.6020106 0.6037715 0.6184764 0.6217567 0.5750941 0.5753166 0.5861177 0.5866547 0.593029 0.5940885 0.6006815 0.6026053 0.5819071 0.5825994 0.594259 0.595206 0.6010416 0.6027772 0.6090058 0.6122351]; Aero.CL.delev = reshape(Aero.CL.delev, sizeArray);
Aero.CL.pHat = [0.277500776972415 0.278761704124733 0.467624550242478 0.330839484799499 0.406205767325442 0.416187516295562 0.296784523126662 0.444265839286646 0.00454479845648433 0.00652270949575012 0.0277981957553319 0.021026208478907 0.14361662408093 0.10184096574021 0.143903311258278 0.207627470407259 -0.292885081086719 -0.420176669969234 -0.24966357615894 -0.248962371590968 0.112199822704281 0.0754359597434427 -0.0138804818271888 -0.0280074047035511]; Aero.CL.pHat = reshape(Aero.CL.pHat, sizeArray);
Aero.CL.qHat = [1.495336206945 1.50213081864213 2.51983410231481 1.78275630686576 2.18887384020546 2.24266133156496 1.59924829016359 2.39396372955081 0.0244900275934158 0.0351481670890913 0.149792908885529 0.113301487571723 0.77389022203989 0.548778583912645 0.775435059935597 1.11881803519144 -1.578235819738 -2.26415722065179 -1.34533311603284 -1.3415546164178 0.604598153320483 0.406492994869086 -0.0747961402936929 -0.150920248846528]; Aero.CL.qHat = reshape(Aero.CL.qHat, sizeArray);
Aero.CL.rHat = [0.277500776972415 0.278761704124733 0.467624550242478 0.330839484799499 0.406205767325442 0.416187516295562 0.296784523126662 0.444265839286646 0.00454479845648433 0.00652270949575012 0.0277981957553319 0.021026208478907 0.14361662408093 0.10184096574021 0.143903311258278 0.207627470407259 -0.292885081086719 -0.420176669969234 -0.24966357615894 -0.248962371590968 0.112199822704281 0.0754359597434427 -0.0138804818271888 -0.0280074047035511]; Aero.CL.rHat = reshape(Aero.CL.rHat, sizeArray);
Aero.CL.alpha = [4.8235049 4.8277348 4.9641455 4.9714838 5.0645226 5.076871 5.1997025 5.2199368 4.8692532 4.8723344 4.9476747 4.9538469 5.0390446 5.0493147 5.1434977 5.1597266 4.8200959 4.8243056 4.9645432 4.9719471 5.0724253 5.0847879 5.1970096 5.2169805]; Aero.CL.alpha = reshape(Aero.CL.alpha, sizeArray);
Aero.CL.beta = [0.033558 0.0335994 0.0638087 0.0636157 0.0667997 0.0663184 0.0690345 0.0683783 -0.0026762 -0.0026757 -0.0086706 -0.0086134 -0.0162144 -0.0158808 -0.0131342 -0.0131851 -0.034333 -0.0343767 -0.0523771 -0.0520993 -0.0745513 -0.0742002 -0.0987556 -0.0981555]; Aero.CL.beta = reshape(Aero.CL.beta, sizeArray);
Aero.CL.alphaDot = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.CL.alphaDot = reshape(Aero.CL.alphaDot, sizeArray);
Aero.CL.betaDot = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.CL.betaDot = reshape(Aero.CL.betaDot, sizeArray);

%% Drag coefficient 
Aero.CD.tot = [0.0008297 0.0008308 0.0010353 0.0010367 0.001902 0.0019051 0.0035311 0.0035375 0 0 0.0004217 0.0004223 0.0016748 0.0016775 0.003752 0.0037588 0.0008259 0.000827 0.0010351 0.0010365 0.0019068 0.0019099 0.0035371 0.0035437]; Aero.CD.tot = reshape(Aero.CD.tot, sizeArray);
Aero.CD.zero = [-0.485571347079452 -0.495085569829502 -0.869556490858707 -0.654292989351264 -1.42821643807376 -1.45744135950288 -1.52735534744194 -2.01900734027518 -0.304897192551658 -0.421833105788167 -0.526429057217775 -0.413991607052533 -0.723566115437931 -0.618131575806587 -0.863529089558931 -1.05437129722726 -0.35228017130355 -0.48193533829073 -0.119688548996032 -0.132683043246142 0.104911414001001 -0.0346951496992329 0.208595877993983 0.177067454780556]; Aero.CD.zero = reshape(Aero.CD.zero, sizeArray);
Aero.CD.dailR = [1.45e-05 1.21e-05 0.0037768 0.0037806 0.0074413 0.0074496 0.0109284 0.0109395 0.000862 0.0008628 0.0043598 0.0043643 0.007876 0.0078824 0.0116183 0.0116253 0.0010197 0.001019 0.0040465 0.0040537 0.0064294 0.0064285 0.0094197 0.0094232]; Aero.CD.dailR = reshape(Aero.CD.dailR, sizeArray);
Aero.CD.dailL = [0.0010145 0.001013 0.0038973 0.0039157 0.0061585 0.0061552 0.0087769 0.0087797 0.0008627 0.0008638 0.0043327 0.0043373 0.0077917 0.0077979 0.0112599 0.0112664 0.0007397 0.0007391 0.0035871 0.0035917 0.0072742 0.0072831 0.0109458 0.010963]; Aero.CD.dailL = reshape(Aero.CD.dailL, sizeArray);
Aero.CD.drud = [0.012239 0.012255 0.0098952 0.0099091 0.0082182 0.0082303 0.0060026 0.0060129 0.0006826 0.0006833 0.0005615 0.0005618 0.0006554 0.0006533 0.0004363 0.000438 -0.0100334 -0.0100489 -0.009348 -0.0094663 -0.0073627 -0.007373 -0.0052445 -0.0052453]; Aero.CD.drud = reshape(Aero.CD.drud, sizeArray);
Aero.CD.dflapR = [-3.73e-05 -4.1e-05 0.0049625 0.0049663 0.0103596 0.010366 0.0165949 0.0166052 0.001099 0.0011017 0.0055515 0.0055582 0.0100455 0.0100546 0.0147988 0.0148082 0.0004169 0.0004157 0.0028121 0.002816 0.0049223 0.0049266 0.0069747 0.0069753]; Aero.CD.dflapR = reshape(Aero.CD.dflapR, sizeArray);
Aero.CD.dflapL = [-0.0005084 -0.0005103 0.0027923 0.0027965 0.0052479 0.0052489 0.0077373 0.0077392 0.0011039 0.0011053 0.0054791 0.0054858 0.0100677 0.0100756 0.0147447 0.0147523 0.0007271 0.0007242 0.004748 0.0047517 0.0103768 0.0103816 0.0155953 0.0155989]; Aero.CD.dflapL = reshape(Aero.CD.dflapL, sizeArray);
Aero.CD.delev = [-0.0004245 -0.0004264 0.0069531 0.0069712 0.0142373 0.0142704 0.021721 0.0217815 0.0019887 0.0019915 0.0109947 0.0110118 0.019163 0.0192015 0.0266858 0.0267501 -8.33e-05 -8.52e-05 0.0070684 0.0070874 0.0142465 0.0142845 0.0213593 0.0214165]; Aero.CD.delev = reshape(Aero.CD.delev, sizeArray);
Aero.CD.pHat = [0.0565580434895969 0.0565940345205194 0.102806695520676 0.0720850706575585 0.154201178495072 0.154591229076498 0.136630640871878 0.195890493820723 0.0367729050424988 0.0525930020336862 0.0533305522240183 0.0373959221984669 0.0575094123168379 0.0402814100224227 0.0419506492152057 0.060081973197059 0.0381194660270115 0.0544173749804453 -0.00282467539239714 -0.00274648798039318 -0.0515593679929082 -0.0361387182562445 -0.0974098138394952 -0.0980214840694582]; Aero.CD.pHat = reshape(Aero.CD.pHat, sizeArray);
Aero.CD.qHat = [0.304767760100258 0.304961700788464 0.553982499817355 0.388436448036147 0.830925981083618 0.833027801349886 0.736245665698181 1.05557235263374 0.19815388246666 0.283401801720795 0.287376152769738 0.201511062655599 0.309894290804255 0.217059755761741 0.22605459112852 0.323756750833141 0.205409939249527 0.29323258832984 -0.0152210002191738 -0.0147996807930719 -0.277831978015185 -0.194736513788278 -0.524900950314992 -0.52819698664164]; Aero.CD.qHat = reshape(Aero.CD.qHat, sizeArray);
Aero.CD.rHat = [0.0565580434895969 0.0565940345205194 0.102806695520676 0.0720850706575585 0.154201178495072 0.154591229076498 0.136630640871878 0.195890493820723 0.0367729050424988 0.0525930020336862 0.0533305522240183 0.0373959221984669 0.0575094123168379 0.0402814100224227 0.0419506492152057 0.060081973197059 0.0381194660270115 0.0544173749804453 -0.00282467539239714 -0.00274648798039318 -0.0515593679929082 -0.0361387182562445 -0.0974098138394952 -0.0980214840694582]; Aero.CD.rHat = reshape(Aero.CD.rHat, sizeArray);
Aero.CD.alpha = [0.0117772 0.0117948 0.0496606 0.0497587 0.0933386 0.0935294 0.1451055 0.1454984 0.024161 0.0241964 0.0717981 0.0719194 0.1190136 0.1192456 0.1663905 0.1667646 0.0119865 0.0120035 0.0499452 0.0500416 0.0934083 0.093608 0.1446461 0.1450059]; Aero.CD.alpha = reshape(Aero.CD.alpha, sizeArray);
Aero.CD.beta = [-0.0073111 -0.0072989 -0.0052174 -0.0052117 0.0014778 0.0014949 0.0078664 0.0079051 0.0024376 0.0024405 0.0013432 0.0013449 4e-06 6.4e-06 0.0002929 0.0002947 0.0152707 0.0152994 0.0115438 0.0115682 0.0071967 0.0072245 -0.0003026 -0.000291]; Aero.CD.beta = reshape(Aero.CD.beta, sizeArray);
Aero.CD.alphaDot = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.CD.alphaDot = reshape(Aero.CD.alphaDot, sizeArray);
Aero.CD.betaDot = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.CD.betaDot = reshape(Aero.CD.betaDot, sizeArray);

%% Side Force coefficient
Aero.CY.tot = [0.0223303 0.0223403 0.0224484 0.022458 0.0221796 0.0221869 0.0216346 0.021636 0 0 -7e-07 -7e-07 -1.1e-06 -1.1e-06 -6e-07 -6e-07 -0.0223368 -0.0223468 -0.022449 -0.0224584 -0.0221485 -0.022156 -0.0215892 -0.0215901]; Aero.CY.tot = reshape(Aero.CY.tot, sizeArray);
Aero.CY.zero = [1.71949110714195 1.64053223939221 2.38649841730165 1.49957743086214 2.64473860910486 2.59232132767755 1.27176018421895 1.67887936888616 6.91487328179349 9.83649277613463 7.60760636963645 5.36736371574624 7.29211323207883 5.14713375695585 4.23351897053455 6.00299946469236 2.63641571014583 3.61071887413718 2.78395465143285 2.8650128861838 2.6656372357802 2.06305148429705 1.71216745381374 1.81467039595909]; Aero.CY.zero = reshape(Aero.CY.zero, sizeArray);
Aero.CY.dailR = [-0.0041665 -0.0041688 -0.0070689 -0.0070785 -0.0083718 -0.0083899 -0.010779 -0.0108051 -0.0085184 -0.0085906 -0.009116 -0.0091235 -0.0095521 -0.0095589 -0.0099084 -0.0099167 -0.0024666 -0.0024727 -0.005482 -0.0054959 -0.0030811 -0.0030821 -0.0027932 -0.0028407]; Aero.CY.dailR = reshape(Aero.CY.dailR, sizeArray);
Aero.CY.dailL = [0.0047063 0.0047099 0.005053 0.005056 0.0020197 0.0020147 -0.0016735 -0.0016815 0.0090229 0.0090289 0.0089498 0.0089562 0.0092824 0.0092924 0.0096988 0.0097073 0.0070679 0.0070639 0.0082504 0.0082544 0.0093167 0.0093336 0.0113205 0.0113077]; Aero.CY.dailL = reshape(Aero.CY.dailL, sizeArray);
Aero.CY.drud = [0.1394269 0.1394757 0.13801 0.1380554 0.137015 0.137061 0.1362075 0.1362533 0.1496709 0.1497087 0.1482823 0.1483129 0.145048 0.1450928 0.1418045 0.1418498 0.1387719 0.1388199 0.1371936 0.1384679 0.1361379 0.1361868 0.1339178 0.1339356]; Aero.CY.drud = reshape(Aero.CY.drud, sizeArray);
Aero.CY.dflapR = [-0.0429918 -0.0430337 -0.0474247 -0.0474793 -0.0590878 -0.0591062 -0.0582481 -0.0582094 -0.0895644 -0.0897897 -0.0920125 -0.0920639 -0.0908758 -0.0909265 -0.0893696 -0.0894343 -0.0483885 -0.0484286 -0.0484827 -0.0485356 -0.0516513 -0.0517009 -0.0554599 -0.0555885]; Aero.CY.dflapR = reshape(Aero.CY.dflapR, sizeArray);
Aero.CY.dflapL = [0.0441296 0.0441723 0.0495694 0.0495976 0.0546363 0.0546963 0.0527689 0.0528603 0.0911659 0.0912115 0.0799786 0.0800196 0.0916987 0.0917692 0.0890375 0.0891028 0.0418365 0.0418813 0.0512162 0.0512815 0.0511666 0.0511714 0.0576984 0.057622]; Aero.CY.dflapL = reshape(Aero.CY.dflapL, sizeArray);
Aero.CY.delev = [-0.002806 -0.0028065 -0.003395 -0.0034161 -0.0061755 -0.0062406 -0.0083057 -0.0084336 3.33e-05 3.3e-05 -1.92e-05 -2.07e-05 0.0001606 0.0001629 0.0001271 0.0001279 0.0007852 0.0007912 0.0035907 0.0036023 0.0053851 0.0054541 0.0050075 0.0051157]; Aero.CY.delev = reshape(Aero.CY.delev, sizeArray);
Aero.CY.pHat = [-0.279008677061063 -0.279196078635866 -0.367273400427596 -0.257792584867289 -0.379724878761016 -0.380625541012671 -0.155858538874694 -0.224045053970903 -0.920772195859624 -1.31615831464776 -1.01237451113313 -0.709173478646295 -0.971357146581843 -0.680424091359441 -0.558482755384054 -0.797940658079992 -0.281773781091933 -0.402734317150754 -0.308127903217396 -0.308799322104604 -0.301156280961569 -0.211458476299734 -0.172491004849559 -0.174267507952234]; Aero.CY.pHat = reshape(Aero.CY.pHat, sizeArray);
Aero.CY.qHat = [-1.50346165301982 -1.50447148212048 -1.97908351644646 -1.38913696112757 -2.04617935158283 -2.05103264565221 -0.83985680646956 -1.20728556094436 -4.96165819007424 -7.09222944683912 -5.4552649473702 -3.82144075845365 -5.23423943891515 -3.66652227423697 -3.00943115976644 -4.29977014853238 -1.51836164796197 -2.17016763983568 -1.66037304499806 -1.66399104197459 -1.62280587385707 -1.13946173169759 -0.929482244114622 -0.939055080054625]; Aero.CY.qHat = reshape(Aero.CY.qHat, sizeArray);
Aero.CY.rHat = [-0.279008677061063 -0.279196078635866 -0.367273400427596 -0.257792584867289 -0.379724878761016 -0.380625541012671 -0.155858538874694 -0.224045053970903 -0.920772195859624 -1.31615831464776 -1.01237451113313 -0.709173478646295 -0.971357146581843 -0.680424091359441 -0.558482755384054 -0.797940658079992 -0.281773781091933 -0.402734317150754 -0.308127903217396 -0.308799322104604 -0.301156280961569 -0.211458476299734 -0.172491004849559 -0.174267507952234]; Aero.CY.rHat = reshape(Aero.CY.rHat, sizeArray);
Aero.CY.alpha = [0.0067695 0.006746 -0.0154048 -0.01553 -0.0312229 -0.0315665 -0.0256554 -0.0263661 -4.07e-05 -3.99e-05 -2.27e-05 -2.49e-05 2.81e-05 2.95e-05 1.27e-05 1.18e-05 -0.0064262 -0.0063943 0.0172118 0.0173226 0.0320457 0.0324231 0.0253572 0.0259803]; Aero.CY.alpha = reshape(Aero.CY.alpha, sizeArray);
Aero.CY.beta = [-0.2344585 -0.2346182 -0.239143 -0.2392968 -0.2408814 -0.2409981 -0.2448208 -0.24486 -0.2634402 -0.2635086 -0.2642455 -0.2643125 -0.2596924 -0.2597432 -0.2476074 -0.2476071 -0.2553349 -0.2555492 -0.2606123 -0.2608283 -0.3022579 -0.3024956 -0.3242968 -0.3245594]; Aero.CY.beta = reshape(Aero.CY.beta, sizeArray);
Aero.CY.alphaDot = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.CY.alphaDot = reshape(Aero.CY.alphaDot, sizeArray);
Aero.CY.betaDot = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.CY.betaDot = reshape(Aero.CY.betaDot, sizeArray);
%% Roll moment coefficient
Aero.Cl.tot = [-0.0004003 -0.0004017 0.0004129 0.0004114 0.0013943 0.0013902 0.002308 0.0022954 0 0 -2e-07 -2e-07 -8e-07 -8e-07 -1.9e-06 -1.9e-06 0.0004014 0.0004028 -0.0004166 -0.0004151 -0.0014085 -0.0014048 -0.0023116 -0.002299]; Aero.Cl.tot = reshape(Aero.Cl.tot, sizeArray);
Aero.Cl.zero = [37.6089239988989 37.6336818119013 55.1659464015579 38.6772223950992 57.3371506676595 57.4986851462555 41.9624520826247 58.8574230716472 37.9326459284617 54.2074609717346 55.578013081279 38.9530736349038 56.893065228312 39.9157106878343 41.1466546043154 58.9514322087005 37.7394580254258 53.9247193416839 38.6315457333426 38.6656027876014 57.206169274826 40.0645379961448 58.7141261912655 59.9442620880882]; Aero.Cl.zero = reshape(Aero.Cl.zero, sizeArray);
Aero.Cl.dailR = [-0.1010105 -0.1010578 -0.1022981 -0.1024516 -0.1030402 -0.1033079 -0.1040534 -0.1044417 -0.1047534 -0.104797 -0.1055406 -0.1056973 -0.1065117 -0.1067761 -0.1076276 -0.1079979 -0.1059937 -0.1060523 -0.1060816 -0.1062365 -0.1097483 -0.1099865 -0.1121772 -0.1125568]; Aero.Cl.dailR = reshape(Aero.Cl.dailR, sizeArray);
Aero.Cl.dailL = [0.105955 0.1060139 0.1063555 0.1065313 0.1104293 0.1106911 0.1120631 0.1123789 0.1046956 0.1047469 0.1056498 0.1058071 0.1066222 0.1068842 0.1077351 0.1081042 0.1007938 0.1008431 0.1020632 0.1021981 0.1030807 0.1033528 0.103429 0.1038194]; Aero.Cl.dailL = reshape(Aero.Cl.dailL, sizeArray);
Aero.Cl.drud = [-0.0067159 -0.0067291 -0.0074567 -0.0074729 -0.0082582 -0.0083085 -0.0089173 -0.0090174 -0.0069275 -0.006931 -0.007485 -0.0074951 -0.0078838 -0.0079077 -0.0083125 -0.0083676 -0.0069419 -0.0069547 -0.0076811 -0.0076878 -0.0078317 -0.0078443 -0.0085627 -0.0086282]; Aero.Cl.drud = reshape(Aero.Cl.drud, sizeArray);
Aero.Cl.dflapR = [-0.0475872 -0.0475855 -0.0454852 -0.04546 -0.0420268 -0.0419069 -0.0392794 -0.0389668 -0.0508155 -0.0508211 -0.0495689 -0.0495907 -0.0488707 -0.0488717 -0.0477258 -0.0476598 -0.055204 -0.0551924 -0.0550487 -0.0550817 -0.0547976 -0.0548224 -0.0545359 -0.0544557]; Aero.Cl.dflapR = reshape(Aero.Cl.dflapR, sizeArray);
Aero.Cl.dflapL = [0.0552384 0.0552265 0.0548276 0.0548718 0.054745 0.0547975 0.0542918 0.0542799 0.0508156 0.0508301 0.0515613 0.0515877 0.0486143 0.0486079 0.0480594 0.0479948 0.0474872 0.0474855 0.0453983 0.0453733 0.0428053 0.0426947 0.0394198 0.0391216]; Aero.Cl.dflapL = reshape(Aero.Cl.dflapL, sizeArray);
Aero.Cl.delev = [0.0023027 0.0022966 7.13e-05 1.35e-05 -0.0024031 -0.0025984 -0.0045979 -0.0050215 6.6e-06 6.6e-06 4.08e-05 4.14e-05 1.84e-05 1.7e-05 8.7e-05 8.44e-05 -0.0019892 -0.0019821 -5.75e-05 8.6e-06 0.0026608 0.0028594 0.0047954 0.0051956]; Aero.Cl.delev = reshape(Aero.Cl.delev, sizeArray);
Aero.Cl.pHat = [-5.08897415654169 -5.09069676174584 -7.46483235125411 -5.23156813891641 -7.74052010220577 -7.75800146008239 -5.60564153934401 -8.03686989622986 -5.13370480262815 -7.33640465140533 -7.52053334723888 -5.2704396933827 -7.69653303436408 -5.39890161130521 -5.56338682797101 -7.97314272305366 -5.10810401001199 -7.30031433488033 -5.22686076028576 -5.23309465505554 -7.7573631954946 -5.44200025029984 -8.01939740313918 -8.04572404442822]; Aero.Cl.pHat = reshape(Aero.Cl.pHat, sizeArray);
Aero.Cl.qHat = [-27.4223639858155 -27.4316463884096 -40.2248750990497 -28.1907436172664 -41.7104416632479 -41.8046414260907 -30.2064695039367 -43.3073473791875 -27.6633988232054 -39.532831668924 -40.5250245868013 -28.4002062481384 -41.4734136595838 -29.0924340652239 -29.9787764483733 -42.9639481625932 -27.5254468054018 -39.3383559719233 -28.1653775127711 -28.1989693774903 -41.8012020838368 -29.3246746955452 -43.2131953849872 -43.3550586992318]; Aero.Cl.qHat = reshape(Aero.Cl.qHat, sizeArray);
Aero.Cl.rHat = [-5.08897415654169 -5.09069676174584 -7.46483235125411 -5.23156813891641 -7.74052010220577 -7.75800146008239 -5.60564153934401 -8.03686989622986 -5.13370480262815 -7.33640465140533 -7.52053334723888 -5.2704396933827 -7.69653303436408 -5.39890161130521 -5.56338682797101 -7.97314272305366 -5.10810401001199 -7.30031433488033 -5.22686076028576 -5.23309465505554 -7.7573631954946 -5.44200025029984 -8.01939740313918 -8.04572404442822]; Aero.Cl.rHat = reshape(Aero.Cl.rHat, sizeArray);
Aero.Cl.alpha = [0.0465905 0.0465877 0.0562342 0.0560807 0.0523513 0.0518666 0.0481138 0.047015 -1.16e-05 -1.2e-05 -3.44e-05 -3.37e-05 -6.5e-05 -6.6e-05 -5.81e-05 -5.9e-05 -0.0468644 -0.0468615 -0.0568329 -0.0567057 -0.0517455 -0.0512386 -0.047879 -0.0467312]; Aero.Cl.alpha = reshape(Aero.Cl.alpha, sizeArray);
Aero.Cl.beta = [0.0034059 0.0034323 -0.0036031 -0.0035715 -0.0190866 -0.0190716 -0.0312697 -0.0313085 0.0051527 0.0051575 -0.006239 -0.0062336 -0.018884 -0.018892 -0.0328219 -0.0328576 0.0045615 0.0045964 -0.002324 -0.0022957 0.0105772 0.010704 0.028005 0.0282297]; Aero.Cl.beta = reshape(Aero.Cl.beta, sizeArray);
Aero.Cl.alphaDot = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.Cl.alphaDot = reshape(Aero.Cl.alphaDot, sizeArray);
Aero.Cl.betaDot = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.Cl.betaDot = reshape(Aero.Cl.betaDot, sizeArray)
%% Pitch moment coefficient
Aero.Cm.tot = [0.0042779 0.004282 0.0073171 0.0072692 0.0076254 0.0074601 0.0047901 0.0043492 0 0 0.0038733 0.0038637 0.0056201 0.0055434 0.0047945 0.0045452 0.0042769 0.0042807 0.0073502 0.0073039 0.007644 0.0074781 0.0046791 0.0042358]; Aero.Cm.tot = reshape(Aero.Cm.tot, sizeArray);
Aero.Cm.zero = [6.63177047540789 6.62080192441159 15.0637013201193 11.9491583968444 23.1673600734907 24.7408146535313 33.4539081795583 26.9584273262379 0.606348662255633 0.619549931436721 1.32205104647148 1.34399107078152 3.22587279337342 4.09961797536111 11.537207260118 13.2440007583834 -5.91174400296279 -8.70153020030929 -4.11930878234132 -3.73866529309606 -2.8165147707342 1.88736531796592 7.34045908713518 -4.95358521007884]; Aero.Cm.zero = reshape(Aero.Cm.zero, sizeArray);
Aero.Cm.dailR = [-0.0650284 -0.0651988 -0.0709423 -0.0712713 -0.0742758 -0.0748898 -0.0768831 -0.0779867 -0.0679197 -0.0674631 -0.0668548 -0.0671175 -0.0635488 -0.0640019 -0.0593207 -0.0600352 -0.0763711 -0.0765545 -0.0669283 -0.0673189 -0.0730451 -0.0736658 -0.0673611 -0.0680019]; Aero.Cm.dailR = reshape(Aero.Cm.dailR, sizeArray);
Aero.Cm.dailL = [-0.0806485 -0.0808511 -0.080305 -0.0806027 -0.071485 -0.0721179 -0.0866166 -0.0877354 -0.067314 -0.0673846 -0.0657231 -0.0659841 -0.0633733 -0.0638247 -0.0610333 -0.061748 -0.0725305 -0.0726914 -0.0775101 -0.0779061 -0.0759409 -0.0765021 -0.0803414 -0.0812016]; Aero.Cm.dailL = reshape(Aero.Cm.dailL, sizeArray);
Aero.Cm.drud = [0.0341184 0.0341756 0.0285014 0.0282665 0.0220291 0.0214805 0.0194552 0.0184668 0.0012043 0.0012043 0.0092737 0.0092394 0.0086276 0.0086774 0.0116712 0.0117489 -0.0311104 -0.0311361 -0.0376071 -0.0393923 -0.0277345 -0.0272972 -0.0215821 -0.0205611]; Aero.Cm.drud = reshape(Aero.Cm.drud, sizeArray);
Aero.Cm.dflapR = [0.2181611 0.2187246 0.2613548 0.262694 0.2869047 0.2899753 0.3228146 0.3293132 0.2858188 0.2863518 0.3118666 0.3122925 0.3261513 0.327328 0.3369636 0.339402 0.3559432 0.357318 0.3648612 0.3656105 0.3946934 0.3955208 0.3867977 0.3884592]; Aero.Cm.dflapR = reshape(Aero.Cm.dflapR, sizeArray);
Aero.Cm.dflapL = [0.3560099 0.3573701 0.3766466 0.3776029 0.4058282 0.4069631 0.4080135 0.4097835 0.290971 0.2912161 0.3061572 0.3066062 0.3273927 0.3286484 0.3505187 0.3530341 0.2204954 0.2210929 0.2617327 0.262957 0.2859207 0.2890684 0.3392854 0.3460186]; Aero.Cm.dflapL = reshape(Aero.Cm.dflapL, sizeArray);
Aero.Cm.delev = [-1.2640005 -1.2655417 -1.3127756 -1.3151003 -1.3448017 -1.3492073 -1.3915862 -1.4000901 -1.2484394 -1.249022 -1.2697107 -1.2709314 -1.2998433 -1.3023016 -1.3279706 -1.3326488 -1.2803596 -1.2819004 -1.2969552 -1.2992487 -1.342544 -1.346862 -1.3845886 -1.3928966]; Aero.Cm.delev = reshape(Aero.Cm.delev, sizeArray);
Aero.Cm.pHat = [-0.824247974135683 -0.826884006883246 -1.61032382541586 -1.13500694582051 -1.97642530114199 -2.00531741148251 -1.64314073108411 -2.40656953642384 -0.00400989727277468 -0.00580111592011263 -0.0305480523543829 -0.0224348229650102 0.140953642384106 0.0988661208739636 0.0939750638786046 0.133829900401523 0.863329269437347 1.2371056995359 0.954824675392397 0.958196662668822 1.53957928768838 1.09203986024926 1.78510371799552 1.83575355895083]; Aero.Cm.pHat = reshape(Aero.Cm.pHat, sizeArray);
Aero.Cm.qHat = [-4.44152932713652 -4.4557338106451 -8.67736496928757 -6.11608010520341 -10.6501334712067 -10.8058210305663 -8.85420161739003 -12.9680017533902 -0.0216076677100837 -0.0312597995964955 -0.164610741762719 -0.120891924851496 0.759540521858369 0.532748382890958 0.506392512124805 0.721153640813528 4.6521221640881 6.66624780123749 5.14515283155653 5.16332306775841 8.29615209535745 5.88454836153556 9.6191810768738 9.89211199217718]; Aero.Cm.qHat = reshape(Aero.Cm.qHat, sizeArray);
Aero.Cm.rHat = [-0.824247974135683 -0.826884006883246 -1.61032382541586 -1.13500694582051 -1.97642530114199 -2.00531741148251 -1.64314073108411 -2.40656953642384 -0.00400989727277468 -0.00580111592011263 -0.0305480523543829 -0.0224348229650102 0.140953642384106 0.0988661208739636 0.0939750638786046 0.133829900401523 0.863329269437347 1.2371056995359 0.954824675392397 0.958196662668822 1.53957928768838 1.09203986024926 1.78510371799552 1.83575355895083]; Aero.Cm.rHat = reshape(Aero.Cm.rHat, sizeArray);
Aero.Cm.alpha = [0.1741326 0.1711565 0.0176623 0.0109353 -0.1624463 -0.1782361 -0.3817405 -0.4146076 0.2219248 0.2213751 0.1000834 0.0962403 -0.0473027 -0.0571943 -0.2263955 -0.2475723 0.1760853 0.1732138 0.0168379 0.0099836 -0.1698784 -0.1857687 -0.375152 -0.4076028]; Aero.Cm.alpha = reshape(Aero.Cm.alpha, sizeArray);
Aero.Cm.beta = [-0.0836978 -0.0837986 -0.0924585 -0.0920061 -0.0894828 -0.0885033 -0.090596 -0.0891519 0.007033 0.0070345 0.0176476 0.0175855 0.0299782 0.0294324 0.0256979 0.0258828 0.0857815 0.0858618 0.0799093 0.079342 0.0731068 0.0722092 0.0569463 0.0553664]; Aero.Cm.beta = reshape(Aero.Cm.beta, sizeArray);
Aero.Cm.alphaDot = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.Cm.alphaDot = reshape(Aero.Cm.alphaDot, sizeArray);
Aero.Cm.betaDot = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.Cm.betaDot = reshape(Aero.Cm.betaDot, sizeArray);
%% Yaw moment coefficient
Aero.Cn.tot = [-0.0087633 -0.0087671 -0.0087198 -0.0087228 -0.0087938 -0.0087938 -0.0087758 -0.0087679 0 0 4e-07 4e-07 8e-07 8e-07 9e-07 9e-07 0.0087653 0.0087691 0.0087203 0.0087232 0.0087827 0.0087828 0.008758 0.00875]; Aero.Cn.tot = reshape(Aero.Cn.tot, sizeArray);
Aero.Cn.zero = [-0.157706452554029 -0.127962911554176 0.500563616859519 0.406421755051222 -0.445446091861088 -0.453658671505482 -0.463775571757938 -0.382563475729797 -2.00212701412335 -2.84577316660516 -1.96148568322129 -1.38773422525506 -1.94228489143203 -1.37642801900267 -1.07814465869569 -1.52457137385196 -0.417445636791656 -0.542516750416766 -0.179407414752477 -0.205233725252823 -0.341661255061683 -0.250142578544224 0.189481111415242 0.050991021768128]; Aero.Cn.zero = reshape(Aero.Cn.zero, sizeArray);
Aero.Cn.dailR = [0.0006638 0.0006652 0.0012717 0.0012792 0.0013034 0.001312 0.0018285 0.0018418 0.0022746 0.0023043 0.002824 0.0028256 0.0031414 0.003138 0.0033259 0.0033138 -0.0002677 -0.0002656 0.0004137 0.0004145 0.0029296 0.0029215 0.0035892 0.0035865]; Aero.Cn.dailR = reshape(Aero.Cn.dailR, sizeArray);
Aero.Cn.dailL = [-0.000639 -0.0006396 -5.85e-05 -5.21e-05 -0.0026248 -0.0026148 -0.0016204 -0.0015961 -0.002505 -0.0025073 -0.0027438 -0.0027449 -0.0030534 -0.0030514 -0.0032708 -0.0032602 -0.0019023 -0.0019005 -0.0018481 -0.0018509 -0.0017552 -0.0017633 -0.0019218 -0.0019162]; Aero.Cn.dailL = reshape(Aero.Cn.dailL, sizeArray);
Aero.Cn.drud = [-0.0601633 -0.0601847 -0.0591883 -0.0592035 -0.0576294 -0.0576303 -0.0564337 -0.056404 -0.0640466 -0.0640638 -0.0631804 -0.0631928 -0.0613824 -0.061394 -0.0595881 -0.0595844 -0.0597127 -0.0597335 -0.0584838 -0.0590482 -0.0572442 -0.0572461 -0.0554544 -0.0554115]; Aero.Cn.drud = reshape(Aero.Cn.drud, sizeArray);
Aero.Cn.dflapR = [0.0147661 0.0147803 0.0143342 0.0143344 0.0166652 0.0165737 0.0136194 0.0133485 0.0337754 0.0338707 0.0335499 0.0335661 0.0317348 0.0317277 0.0295756 0.0295154 0.0174556 0.0174743 0.018285 0.01831 0.0161371 0.0161401 0.016732 0.0167178]; Aero.Cn.dflapR = reshape(Aero.Cn.dflapR, sizeArray);
Aero.Cn.dflapL = [-0.0156815 -0.015701 -0.0187792 -0.0187931 -0.0175135 -0.0175234 -0.0154137 -0.0153827 -0.0344413 -0.0344593 -0.02877 -0.0287823 -0.0320305 -0.0320307 -0.0295781 -0.029519 -0.014538 -0.0145532 -0.0159824 -0.0159836 -0.0135008 -0.0134051 -0.0134711 -0.0131844]; Aero.Cn.dflapL = reshape(Aero.Cn.dflapL, sizeArray);
Aero.Cn.delev = [0.003095 0.0031034 0.0038915 0.003941 0.0061096 0.0062489 0.0081041 0.0084121 -1.59e-05 -1.58e-05 -1.06e-05 -1.01e-05 -6.66e-05 -6.78e-05 -2.35e-05 -2.32e-05 -0.0021564 -0.002167 -0.0038479 -0.0038889 -0.0057479 -0.0058872 -0.0067797 -0.0070814]; Aero.Cn.delev = reshape(Aero.Cn.delev, sizeArray);
Aero.Cn.pHat = [0.038460760285759 0.0385650101684309 -0.0525380403608489 -0.0364626375345466 0.053655003389477 0.0547489179746571 0.00565059185482609 0.0110419773687229 0.265768941961725 0.379935860666423 0.259220524586745 0.181568545653648 0.256697606507796 0.17986207435991 0.139305146790426 0.199695259946811 0.029652886270011 0.0424428221306774 0.0017635605152005 0.00200929238149867 0.0439090577254002 0.0314809824268655 0.00948886687177348 0.0125188507065756]; Aero.Cn.pHat = reshape(Aero.Cn.pHat, sizeArray);
Aero.Cn.qHat = [0.207249031982511 0.207810791217314 -0.283105636137821 -0.196481979982129 0.289124485082134 0.295019135556168 0.0304486880482857 0.0595006209923514 1.4321182301999 2.04731624527231 1.3968315340478 0.978397333947769 1.38323657841644 0.969201870282847 0.750657465114841 1.07607465395833 0.159787064251634 0.228706706155411 0.00950309372207642 0.0108272404898253 0.236607639610882 0.169637913690493 0.0511315548412114 0.0674588768187208]; Aero.Cn.qHat = reshape(Aero.Cn.qHat, sizeArray);
Aero.Cn.rHat = [0.038460760285759 0.0385650101684309 -0.0525380403608489 -0.0364626375345466 0.053655003389477 0.0547489179746571 0.00565059185482609 0.0110419773687229 0.265768941961725 0.379935860666423 0.259220524586745 0.181568545653648 0.256697606507796 0.17986207435991 0.139305146790426 0.199695259946811 0.029652886270011 0.0424428221306774 0.0017635605152005 0.00200929238149867 0.0439090577254002 0.0314809824268655 0.00948886687177348 0.0125188507065756]; Aero.Cn.rHat = reshape(Aero.Cn.rHat, sizeArray);
Aero.Cn.alpha = [0.0024907 0.0025345 -0.0042387 -0.0040684 0.0010313 0.0014864 0.0048434 0.005782 2.06e-05 2.03e-05 2.27e-05 2.36e-05 5.6e-06 5.3e-06 8.3e-06 8.9e-06 -0.0025799 -0.0026294 0.0035775 0.0034158 -0.0014155 -0.0018838 -0.0047471 -0.0056496]; Aero.Cn.alpha = reshape(Aero.Cn.alpha, sizeArray);
Aero.Cn.beta = [0.0927066 0.0927658 0.0904309 0.0904811 0.0951202 0.0951477 0.0996874 0.0996811 0.1034091 0.1034361 0.1047597 0.104787 0.106829 0.1068635 0.1078164 0.1078737 0.0990338 0.0991136 0.0967315 0.0968038 0.0823647 0.0823829 0.0578139 0.0577545]; Aero.Cn.beta = reshape(Aero.Cn.beta, sizeArray);
Aero.Cn.alphaDot = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.Cn.alphaDot = reshape(Aero.Cn.alphaDot, sizeArray);
Aero.Cn.betaDot = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]; Aero.Cn.betaDot = reshape(Aero.Cn.betaDot, sizeArray);

%% Aero Tables
coefList = {'CL', 'CY', 'CD', 'Cl', 'Cm', 'Cn'};
[Aero] = GenAeroTable(Aero, coefList, Aero.stabFields, Aero.cntrlFields);
end



% Tables for Simulink
function [Aero] = GenAeroTable(Aero, coefList, stabFields, cntrlFields)
numCoef = length(coefList);
for indxCoef = 1:numCoef
    coef = coefList{indxCoef};
    
    % Stability Table
    Aero.(coef).tableStab = Aero.(coef).(stabFields{1});
    for indxSurf = 2:length(stabFields)
        Aero.(coef).tableStab = cat(Aero.tableDim, Aero.(coef).tableStab, Aero.(coef).(stabFields{indxSurf}));
    end
    Aero.(coef).tableSelStab = 1:size(Aero.(coef).tableStab, Aero.tableDim); % Table select for choosing active fields
    
    % Control Table
    Aero.(coef).tableCntrl = Aero.(coef).(cntrlFields{1});
    for indxSurf = 2:length(Aero.cntrlFields)
        Aero.(coef).tableCntrl = cat(Aero.tableDim, Aero.(coef).tableCntrl, Aero.(coef).(cntrlFields{indxSurf}));
    end
    Aero.(coef).tableSelCntrl = 1:size(Aero.(coef).tableCntrl, Aero.tableDim); % Table select for choosing active fields
end

end