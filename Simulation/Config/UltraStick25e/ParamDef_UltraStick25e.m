function [AC] = ParamDef_UltraStick25e()
% function [AC] = ParamDef_UltraStick25e()
% Ultra Stick 25e configuration file. Sets aircraft parameters.
% Called from: SimConfig.m
%
% University of Minnesota 
% Aerospace Engineering and Mechanics 
% Copyright 2017 Regents of the University of Minnesota. All rights reserved.
%

%%
AC.aircraft = 'UltraStick25e';


%% Inertia, Mass and CG location
% Gross aircraft mass [kg] (including relevant hardware)
% AC.Mass  = 1.9; % Loki
% AC.Mass  = 1.959; % Thor
% AC.Mass  = 1.865; % Frigg
AC.Mass = 1.793; % AVL Model

% CG location [x y z], [m]
AC.Geometry.rCG = [0.222417132 0.0 0.027170888];

% Gross moments of inertia [Jx Jy Jz Jxz] [kg*m^2]
% AC.Inertia.Ixx = 0.0894; % 
% AC.Inertia.Iyy = 0.1444; % 
% AC.Inertia.Izz = 0.162; % 
AC.Inertia.Ixx = 0.0437912; % AVL Model
AC.Inertia.Iyy = 0.08381; % AVL Model
AC.Inertia.Izz = 0.119344; % AVL Model
AC.Inertia.Ixy = 0.0;
AC.Inertia.Ixz = -0.000241577;
AC.Inertia.Iyz = 0.0;
AC.Inertia.Matrix = [AC.Inertia.Ixx, -AC.Inertia.Ixy, -AC.Inertia.Ixz;
    -AC.Inertia.Ixy, AC.Inertia.Iyy, -AC.Inertia.Iyz;
    -AC.Inertia.Ixz, -AC.Inertia.Iyz, AC.Inertia.Izz];


%% Aircraft Geometric Parameters

% Remarks:
% ALL stability derivative units are radians.
% Forces are defined in the stability frame, Moments in the body frame

% Aerodynamic force application point (usually the aerodynamic center)[x y z]
AC.Geometry.AeroCenter = [0.22241764 0.0 0.02717038];
% Mean aerodynamic chord [m]
AC.Geometry.c = 0.2530602;
% Wing span [m]
AC.Geometry.b = 1.26365;
% Wing area [m^2]
AC.Geometry.S = 0.3093671232;
% Wing Aspect Ratio [m^2]
AC.Geometry.AR = AC.Geometry.b^2 / AC.Geometry.S;

% Control Surfaces
AC.Aero.surfDesc = {'delev', 'dailL', 'dailR', 'drud', 'dflapL', 'dflapR'}; % Sequence as defined in Effector Subsystem

%%
% Flow Conditions
AC.Aero.vel = [10 10 10 10 10;12 12 12 12 12;14 14 14 14 14;16 16 16 16 16;18 18 18 18 18;20 20 20 20 20;25 25 25 25 25;30 30 30 30 30;40 40 40 40 40];
AC.Aero.Mach = [0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0];
AC.Aero.alpha = [0.30779754023546 0.29965906993341 0.297027113421403 0.29965906993341 0.307795794906208;0.207100769041647 0.202056767503384 0.200416158006509 0.202056767503384 0.207100769041647;0.1501529444771 0.146603817443169 0.145447013214947 0.146603817443169 0.1501529444771;0.114198289221391 0.111534916782847 0.110665917348279 0.111534742249922 0.114198289221391;0.0898935321898183 0.0878104817275631 0.0871305014509861 0.0878104817275631 0.0898935321898183;0.0726479338508624 0.0709696252421446 0.0704217663899436 0.0709696252421446 0.0726479338508624;0.0463631007829026 0.04529321395143 0.0449437990351808 0.04529321395143 0.0463631007829026;0.0321597858630979 0.0314150538712719 0.0311719295064691 0.0314150538712719 0.0321597858630979;0.0180777713263069 0.0176540053839226 0.0175156007742395 0.0176540053839226 0.0180777713263069];
AC.Aero.beta = [-0.174532925199433 -0.0872664625997165 0 0.0872664625997165 0.174532925199433;-0.174532925199433 -0.0872664625997165 0 0.0872664625997165 0.174532925199433;-0.174532925199433 -0.0872664625997165 0 0.0872664625997165 0.174532925199433;-0.174532925199433 -0.0872664625997165 0 0.0872664625997165 0.174532925199433;-0.174532925199433 -0.0872664625997165 0 0.0872664625997165 0.174532925199433;-0.174532925199433 -0.0872664625997165 0 0.0872664625997165 0.174532925199433;-0.174532925199433 -0.0872664625997165 0 0.0872664625997165 0.174532925199433;-0.174532925199433 -0.0872664625997165 0 0.0872664625997165 0.174532925199433;-0.174532925199433 -0.0872664625997165 0 0.0872664625997165 0.174532925199433];
AC.Aero.NeutralPoint = [0.3523857824 0.351153476 0.3507639924 0.3511533236 0.3523854776;0.3392533474 0.338728685 0.33856041 0.3387286596 0.3392532204;0.3334931608 0.3332043374 0.3331110686 0.333204312 0.3334930846;0.3303926082 0.3302106934 0.3301516384 0.3302107188 0.3303925828;0.3285127288 0.3283881672 0.3283476288 0.3283881418 0.3285127288;0.327279 0.3271887284 0.3271592644 0.3271887284 0.327279;0.3255513682 0.3255042512 0.3254888334 0.3255042258 0.3255513682;0.3246917052 0.3246637144 0.324654545 0.3246637398 0.3246917052;0.323888862 0.3238771526 0.3238732918 0.323877178 0.3238888874];

AC.Aero.alphaDot = zeros(size(AC.Aero.alpha));
AC.Aero.betaDot = zeros(size(AC.Aero.beta));

% Trim
AC.Aero.pHat = [0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0];
AC.Aero.qHat = [0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0];
AC.Aero.rHat = [0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0];
AC.Aero.dflapR = [0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0];
AC.Aero.dailR = [0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0];
AC.Aero.dailL = [0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0];
AC.Aero.dflapL = [0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0];
AC.Aero.delev = [-0.428572579144216 -0.413825594162415 -0.409139210587885 -0.413823499767312 -0.42856804128816;-0.27444098210427 -0.266856653839728 -0.264419650605169 -0.266855781175102 -0.274439062242092;-0.194008879789512 -0.189356530135396 -0.187855197912831 -0.189356181069546 -0.194007832591961;-0.145268291499543 -0.142178186058887 -0.141178810529195 -0.142178011525962 -0.145267767900768;-0.113111821762024 -0.110973618895406 -0.110281072248215 -0.110973444362481 -0.113111472696174;-0.0906517032168847 -0.0891437387431616 -0.0886550465526032 -0.0891437387431616 -0.0906513541510343;-0.0569493953608742 -0.0563367847934242 -0.0561383408574724 -0.0563367847934242 -0.0569493953608742;-0.0389885610944509 -0.038829387066669 -0.0387780743866604 -0.038829387066669 -0.0389885610944509;-0.0213452022189655 -0.0216159027859498 -0.0217045655119511 -0.0216159027859498 -0.0213452022189655];
AC.Aero.drud = [-0.351801130402591 -0.170043763830378 -8.22050077689329e-05 0.169876561288037 0.351624154016439;-0.257596111361571 -0.126010677598888 -3.80481776934764e-05 0.12593353404595 0.257515128084279;-0.221403742261741 -0.108931060071797 -2.02458193231342e-05 0.10888987030145 0.221360632629216;-0.204347337613701 -0.100855247089894 -1.18682389135614e-05 0.100830987013291 0.204322030339547;-0.195296932777484 -0.0965638315250903 -7.50491578357562e-06 0.0965486471605979 0.195281050281291;-0.190085903229805 -0.0940910490408647 -4.88692190558412e-06 0.0940811006641284 0.190075431254293;-0.184092093512606 -0.0912451151625628 -2.0943951023932e-06 0.091240926372358 0.184087730189476;-0.181845854765289 -0.0901778463249682 -1.0471975511966e-06 0.090175926462791 0.181843760370187;-0.180319040735645 -0.0894519638890638 -3.49065850398866e-07 0.0894514402902882 0.180318342603944];

% Breakpoint Definitions
AC.Aero.velBkPts = [10 12 14 16 18 20 25 30 40];
AC.Aero.betaBkPts = [-0.174532925199433 -0.0872664625997165 0 0.0872664625997165 0.174532925199433];

AC.Aero.breakPts = {AC.Aero.velBkPts, AC.Aero.betaBkPts};
AC.Aero.breakDesc = {'velocity_mps', 'beta_rad'};



%% Aero Table Setup
% Stability Table Fields, Sequence must match Simulink Model
AC.Aero.stabFields = {'zero', 'alpha', 'beta', 'alphaDot', 'betaDot', 'pHat', 'qHat', 'rHat'};
AC.Aero.stabDragFields = {'vis', 'osw'};

% Control Surfaces, Sequence must match that defined in Effector Subsystem
AC.Aero.cntrlFields = {'delev', 'drud', 'dailL', 'dailR', 'dflapL', 'dflapR'};

% Setup Lookup Tables
depList = [AC.Aero.stabFields{2:end}, AC.Aero.cntrlFields]; % Dependency vector, used to back compute the 'zero' term

% Dimension of the result of the table lookup
AC.Aero.tableDim = length(AC.Aero.breakPts) + 1;


%% Lift coefficient
AC.Aero.CL.tot = [0.92827 0.92827 0.92827 0.92827 0.92827;0.64463 0.64463 0.64463 0.64463 0.64463;0.47361 0.47361 0.47361 0.47361 0.47361;0.3626 0.3626 0.3626 0.3626 0.3626;0.2865 0.2865 0.2865 0.2865 0.2865;0.23207 0.23207 0.23207 0.23207 0.23207;0.14852 0.14852 0.14852 0.14852 0.14852;0.10314 0.10314 0.10314 0.10314 0.10314;0.05802 0.05802 0.05802 0.05802 0.05802];
AC.Aero.CL.alpha = [3.46542 3.567226 3.601323 3.567228 3.465426;3.670898 3.765875 3.797786 3.765875 3.670901;3.756275 3.848655 3.879728 3.848656 3.756277;3.797132 3.888301 3.918981 3.8883 3.797132;3.818708 3.909239 3.939711 3.90924 3.818709;3.830979 3.921143 3.951496 3.921143 3.830979;3.844733 3.934475 3.964691 3.934475 3.844733;3.849645 3.939228 3.969392 3.939228 3.849646;3.852754 3.942225 3.972352 3.942225 3.852753];
AC.Aero.CL.beta = [0.330214 0.164127 -4e-06 -0.164136 -0.330223;0.236686 0.117578 -2e-06 -0.117583 -0.236691;0.179384 0.089089 -1e-06 -0.089092 -0.179386;0.141868 0.070446 -1e-06 -0.070448 -0.141869;0.116005 0.057597 0 -0.057598 -0.116006;0.097435 0.048373 0 -0.048374 -0.097436;0.068821 0.034163 0 -0.034163 -0.068821;0.053219 0.026416 0 -0.026416 -0.05322;0.037665 0.018693 0 -0.018693 -0.037665];
AC.Aero.CL.pHat = [0.004145 0.001994 1.3e-05 -0.001968 -0.004118;0.002784 0.001391 6e-06 -0.001379 -0.002772;0.002821 0.001427 3e-06 -0.00142 -0.002814;0.003093 0.001567 2e-06 -0.001563 -0.003089;0.00337 0.001706 1e-06 -0.001703 -0.003368;0.003608 0.001824 1e-06 -0.001822 -0.003606;0.004027 0.00203 0 -0.00203 -0.004026;0.004278 0.002154 0 -0.002154 -0.004278;0.004543 0.002284 0 -0.002284 -0.004542];
AC.Aero.CL.qHat = [7.352051 7.463041 7.499904 7.463042 7.352053;7.638023 7.739921 7.773886 7.739922 7.638024;7.776312 7.874669 7.907493 7.874669 7.776313;7.854064 7.950678 7.982938 7.950678 7.854064;7.902237 7.997877 8.029819 7.997877 7.902237;7.934218 8.029261 8.061008 8.029261 7.934218;7.979379 8.073657 8.105157 8.073657 7.979379;8.001953 8.095893 8.127281 8.095892 8.001953;8.023053 8.116705 8.147998 8.116705 8.023052];
AC.Aero.CL.rHat = [-0.004132 -0.002373 1e-06 0.002375 0.004135;-0.010928 -0.005635 1e-06 0.005637 0.01093;-0.014071 -0.007151 1e-06 0.007152 0.014073;-0.01574 -0.007957 1e-06 0.007958 0.015741;-0.016715 -0.008428 0 0.008429 0.016716;-0.017327 -0.008725 0 0.008725 0.017327;-0.018125 -0.009112 0 0.009112 0.018125;-0.018485 -0.009287 0 0.009287 0.018485;-0.018792 -0.009436 0 0.009436 0.018792];
AC.Aero.CL.dflapR = [0.269404755270513 0.27696779816624 0.27920233356725 0.276051065694031 0.267571290326094;0.288255066730317 0.295245151830913 0.297307799893384 0.294328419358704 0.286364306006385;0.29593270118507 0.302750898947127 0.304698955450572 0.301776870695405 0.294041940461139;0.299599631073907 0.306303237276938 0.308251293780383 0.305329209025216 0.297708870349976;0.301490391797839 0.30819399800087 0.310084758724802 0.307219969749147 0.299599631073907;0.302579011608588 0.309225322032105 0.311116082756037 0.308251293780383 0.300688250884656;0.303839518757876 0.31042853340188 0.312319294125812 0.309454505150158 0.301891462254431;0.304240589214467 0.310829603858472 0.312720364582403 0.309855575606749 0.302292532711022;0.304527068112033 0.311116082756037 0.313006843479969 0.310142054504315 0.302579011608588];
AC.Aero.CL.dailR = [0.357411072602608 0.366120031088596 0.367781608694475 0.362395805420246 0.350134508604446;0.381475299998102 0.389382117570907 0.390699920499708 0.385486004564018 0.373797665543349;0.391330174074352 0.398893216970079 0.400096428339854 0.394882512404163 0.383423356501547;0.395971132214912 0.403419583551613 0.404565499141874 0.399408878985697 0.388007018862593;0.398434850733975 0.405826006291162 0.406914626101911 0.401758005945733 0.390413441602143;0.399809949442288 0.407143809219963 0.408289724810225 0.403075808874534 0.391788540310457;0.401356935489142 0.408690795266816 0.409779415077565 0.404565499141874 0.39333552635731;0.401929893284273 0.409206457282434 0.410295077093183 0.405138456937005 0.393851188372928;0.402273667961351 0.409550231959512 0.410638851770261 0.405482231614084 0.394194963050006];
AC.Aero.CL.dailL = [0.350134508604446 0.362395805420246 0.367781608694475 0.366120031088596 0.357411072602608;0.373797665543349 0.385428708784505 0.390699920499708 0.389382117570907 0.381475299998102;0.383423356501547 0.394882512404163 0.400096428339854 0.398893216970079 0.391330174074352;0.388007018862593 0.399408878985697 0.404565499141874 0.403419583551613 0.395971132214912;0.390413441602143 0.401758005945733 0.406914626101911 0.405826006291162 0.398434850733975;0.391788540310457 0.403075808874534 0.408289724810225 0.407143809219963 0.399809949442288;0.39333552635731 0.404565499141874 0.409779415077565 0.408690795266816 0.401356935489142;0.393851188372928 0.405138456937005 0.410295077093183 0.409206457282434 0.401929893284273;0.394194963050006 0.405482231614084 0.410638851770261 0.409550231959512 0.402273667961351];
AC.Aero.CL.dflapL = [0.267571290326094 0.276051065694031 0.27920233356725 0.27696779816624 0.269404755270513;0.286364306006385 0.294328419358704 0.297307799893384 0.295245151830913 0.288255066730317;0.294041940461139 0.301776870695405 0.304698955450572 0.302750898947127 0.29593270118507;0.297708870349976 0.305329209025216 0.308251293780383 0.306303237276938 0.299599631073907;0.299599631073907 0.307219969749147 0.310084758724802 0.30819399800087 0.301490391797839;0.300688250884656 0.308251293780383 0.311116082756037 0.309225322032105 0.302579011608588;0.301891462254431 0.309454505150158 0.312319294125812 0.31042853340188 0.303839518757876;0.302292532711022 0.309855575606749 0.312720364582403 0.310829603858472 0.304240589214467;0.302579011608588 0.310142054504315 0.313006843479969 0.311116082756037 0.304527068112033];
AC.Aero.CL.delev = [0.470341054022893 0.483576379090415 0.488045449892435 0.483576379090415 0.470341054022893;0.495322013890597 0.507869789603962 0.51210967728793 0.507869789603962 0.495322013890597;0.505577958423438 0.517839255239238 0.522021847143693 0.517839255239238 0.505577958423438;0.51044809968205 0.522652100718337 0.526720101063766 0.522652100718337 0.51044809968205;0.513026409760139 0.525173115016913 0.529241115362341 0.525173115016913 0.513026409760139;0.514516100027479 0.52660550950474 0.530673509850168 0.52660550950474 0.514516100027479;0.516177677633359 0.528209791331106 0.532277791676535 0.528209791331106 0.516177677633359;0.516750635428489 0.528782749126237 0.532850749471666 0.528782749126237 0.516750635428489;0.517151705885081 0.529183819582828 0.533251819928257 0.529183819582828 0.517151705885081];
AC.Aero.CL.drud = [-0.00572957795130823 -0.00303667631419336 0 0.00303667631419336 0.00572957795130823;-0.00813600069085769 -0.00418259190445501 0 0.00418259190445501 0.00813600069085769;-0.00911002894258009 -0.00464095814055967 0 0.00464095814055967 0.00911002894258009;-0.00962569095819783 -0.004870141258612 0 0.004870141258612 0.00962569095819783;-0.00991216985576324 -0.00504202859715124 0 0.00504202859715124 0.00991216985576324;-0.0100840571943025 -0.00515662015617741 0 0.00515662015617741 0.0100840571943025;-0.0103705360918679 -0.00527121171520357 0 0.00527121171520357 0.0103705360918679;-0.0104851276508941 -0.00532850749471666 0 0.00532850749471666 0.0104851276508941;-0.0105997192099202 -0.00538580327422974 0 0.00538580327422974 0.0105997192099202];

% Tables for alphaDot and betaDot (not available from AVL)
AC.Aero.CL.alphaDot = zeros(size(AC.Aero.CL.alpha));
AC.Aero.CL.betaDot = zeros(size(AC.Aero.CL.beta));

% Create a zero term, start with the total and remove the trim conditions
AC.Aero.CL.zero = AC.Aero.CL.tot;
for indxDep = 1:length(depList)
    AC.Aero.CL.zero = AC.Aero.CL.zero - (AC.Aero.CL.(depList{indxDep}) .* AC.Aero.(depList{indxDep}));
end

% Table for Simulink
coef = 'CL';

% Stability Table
AC.Aero.(coef).tableStab = AC.Aero.(coef).(AC.Aero.stabFields{1});
for indxSurf = 2:length(AC.Aero.stabFields)
    AC.Aero.(coef).tableStab = cat(AC.Aero.tableDim, AC.Aero.(coef).tableStab, AC.Aero.(coef).(AC.Aero.stabFields{indxSurf}));
end
AC.Aero.(coef).tableSelStab = 1:size(AC.Aero.(coef).tableStab, AC.Aero.tableDim); % Table select for choosing active fields

% Control Table
AC.Aero.(coef).tableCntrl = AC.Aero.(coef).(AC.Aero.cntrlFields{1});
for indxSurf = 2:length(AC.Aero.cntrlFields)
    AC.Aero.(coef).tableCntrl = cat(AC.Aero.tableDim, AC.Aero.(coef).tableCntrl, AC.Aero.(coef).(AC.Aero.cntrlFields{indxSurf}));
end
AC.Aero.(coef).tableSelCntrl = 1:size(AC.Aero.(coef).tableCntrl, AC.Aero.tableDim); % Table select for choosing active fields


%% Drag coefficient (CD = CD_vis + (CL - CL_minD)^2 / (pi*AR*osw) + CD_surf)
AC.Aero.CD.tot = [0.09125 0.08664 0.08519 0.08664 0.09125;0.0428 0.04105 0.04049 0.04105 0.0428;0.0227 0.02194 0.0217 0.02194 0.0227;0.01309 0.01277 0.01267 0.01277 0.01309;0.00802 0.00792 0.00789 0.00792 0.00802;0.00514 0.00516 0.00517 0.00516 0.00514;0.00191 0.00206 0.00211 0.00206 0.00191;0.00076 0.00095 0.00102 0.00095 0.00076;2e-05 0.00025 0.00032 0.00025 2e-05];
AC.Aero.CD.vis = [0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0];
AC.Aero.CD.ind = [0.09125 0.08664 0.08519 0.08664 0.09125;0.0428 0.04105 0.04049 0.04105 0.0428;0.0227 0.02194 0.0217 0.02194 0.0227;0.01309 0.01277 0.01267 0.01277 0.01309;0.00802 0.00792 0.00789 0.00792 0.00802;0.00514 0.00516 0.00517 0.00516 0.00514;0.00191 0.00206 0.00211 0.00206 0.00191;0.00076 0.00095 0.00102 0.00095 0.00076;2e-05 0.00025 0.00032 0.00025 2e-05];
AC.Aero.CD.osw = [0.7766 0.7837 0.7859 0.7837 0.7766;0.7894 0.792 0.7927 0.792 0.7894;0.7956 0.7962 0.7963 0.7962 0.7956;0.799 0.7987 0.7986 0.7987 0.799;0.8009 0.8003 0.8 0.8003 0.8009;0.8019 0.8013 0.8011 0.8013 0.8019;0.8013 0.8023 0.8026 0.8023 0.8013;0.7965 0.8016 0.8034 0.8016 0.7965;0.7709 0.7952 0.8043 0.7952 0.7709];
AC.Aero.CD.dflapR = [0.0472117223187798 0.0476700885548845 0.0481284547909892 0.0485295252475807 0.0490451872631985;0.0332315521175878 0.033403439456127 0.0335753267946662 0.0338045099127186 0.0339763972512578;0.0245798894111123 0.0246371851906254 0.0246944809701385 0.0248090725291646 0.0248663683086777;0.0189076072393172 0.0189076072393172 0.0189076072393172 0.0189649030188303 0.0189649030188303;0.0150114942324276 0.0149541984529145 0.0149541984529145 0.0149541984529145 0.0149541984529145;0.0122040010362865 0.0121467052567735 0.0120894094772604 0.0120894094772604 0.0120894094772604;0.00784952179329228 0.0077922260137792 0.00773493023426611 0.00767763445475303 0.00767763445475303;0.0055003948332559 0.00544309905374282 0.00538580327422974 0.00532850749471666 0.00527121171520357;0.00315126787321953 0.00309397209370645 0.00303667631419336 0.00297938053468028 0.0029220847551672];
AC.Aero.CD.dailR = [0.064744230849783 0.0645723435112438 0.0644004561727045 0.0643431603931914 0.0642285688341653;0.0450917784767958 0.0449771869177696 0.0448625953587435 0.0447480037997173 0.0446907080202042;0.0331169605585616 0.0330023689995354 0.0329450732200223 0.0328877774405093 0.0328304816609962;0.0253247345447824 0.0252674387652693 0.0252101429857562 0.0251528472062431 0.0250955514267301;0.0199962270500657 0.0199389312705527 0.0198816354910396 0.0198816354910396 0.0198243397115265;0.0162147056022023 0.0161574098226892 0.0161001140431761 0.0161001140431761 0.0160428182636631;0.0103705360918679 0.0103132403123548 0.0103132403123548 0.0102559445328417 0.0102559445328417;0.00716197243913529 0.00716197243913529 0.00716197243913529 0.00710467665962221 0.00710467665962221;0.00406800034542884 0.00401070456591576 0.00401070456591576 0.00401070456591576 0.00401070456591576];
AC.Aero.CD.dailL = [0.0642285688341653 0.0643431603931914 0.0644004561727045 0.0645723435112438 0.064744230849783;0.0446907080202042 0.0447480037997173 0.0448625953587435 0.0449771869177696 0.0450917784767958;0.0328304816609962 0.0328877774405093 0.0329450732200223 0.0330023689995354 0.0331169605585616;0.0250955514267301 0.0251528472062431 0.0252101429857562 0.0252674387652693 0.0253247345447824;0.0198243397115265 0.0198816354910396 0.0198816354910396 0.0199389312705527 0.0199962270500657;0.0160428182636631 0.0161001140431761 0.0161001140431761 0.0161574098226892 0.0162147056022023;0.0102559445328417 0.0102559445328417 0.0103132403123548 0.0103132403123548 0.0103705360918679;0.00710467665962221 0.00710467665962221 0.00716197243913529 0.00716197243913529 0.00716197243913529;0.00401070456591576 0.00401070456591576 0.00401070456591576 0.00401070456591576 0.00406800034542884];
AC.Aero.CD.dflapL = [0.0490451872631985 0.0485295252475807 0.0481284547909892 0.0476700885548845 0.0472117223187798;0.0339763972512578 0.0338045099127186 0.0335753267946662 0.033403439456127 0.0332315521175878;0.0248663683086777 0.0248090725291646 0.0246944809701385 0.0246371851906254 0.0245798894111123;0.0189649030188303 0.0189649030188303 0.0189076072393172 0.0189076072393172 0.0189076072393172;0.0149541984529145 0.0149541984529145 0.0149541984529145 0.0149541984529145 0.0150114942324276;0.0120894094772604 0.0120894094772604 0.0120894094772604 0.0121467052567735 0.0122040010362865;0.00767763445475303 0.00767763445475303 0.00773493023426611 0.0077922260137792 0.00784952179329228;0.00527121171520357 0.00532850749471666 0.00538580327422974 0.00544309905374282 0.0055003948332559;0.0029220847551672 0.00297938053468028 0.00303667631419336 0.00309397209370645 0.00315126787321953];
AC.Aero.CD.delev = [0.0165584802792808 0.0171314380744116 0.0173033254129509 0.0171314380744116 0.0165584802792808;0.0134645081855743 0.0136363955241136 0.0136936913036267 0.0136363955241136 0.0134645081855743;0.0107143107689464 0.0107143107689464 0.0107143107689464 0.0107143107689464 0.0107143107689464;0.00859436692696235 0.00853707114744926 0.00847977536793618 0.00853707114744926 0.00859436692696235;0.00704738088010913 0.00693278932108296 0.00687549354156988 0.00693278932108296 0.00704738088010913;0.0058441695103344 0.00572957795130823 0.00567228217179515 0.00572957795130823 0.0058441695103344;0.00395340878640268 0.00378152144786343 0.00372422566835035 0.00378152144786343 0.00395340878640268;0.00286478897565412 0.00269290163711487 0.00263560585760179 0.00269290163711487 0.00286478897565412;0.00171887338539247 0.00154698604685322 0.00148969026734014 0.00154698604685322 0.00171887338539247];
AC.Aero.CD.drud = [-0.0093965078401455 -0.0045263665815335 0 0.00446907080202042 0.0093965078401455;-0.00378152144786343 -0.00177616916490555 0 0.00177616916490555 0.00378152144786343;-0.00143239448782706 -0.000687549354156988 0 0.000687549354156988 0.00143239448782706;-0.000343774677078494 -0.000114591559026165 0 0.000114591559026165 0.000286478897565412;0.000286478897565412 0.000171887338539247 0 -0.000171887338539247 -0.000286478897565412;0.000630253574643905 0.000343774677078494 0 -0.000343774677078494 -0.000630253574643905;0.00103132403123548 0.000572957795130823 0 -0.000572957795130823 -0.00103132403123548;0.00120321136977473 0.000630253574643905 0 -0.000630253574643905 -0.00120321136977473;0.00131780292880089 0.000687549354156988 0 -0.000687549354156988 -0.00131780292880089];

% Viscous Drag
AC.Aero.CD.vis = AC.Aero.CD.vis + 0.0434; % AVL doesn't estimate viscous effects, value is from previous UltraStick25e model
AC.Aero.CD.tot = AC.Aero.CD.vis + AC.Aero.CD.tot; % Fix Total Drag

% Find CL at minimum Drag
AC.Aero.CL.minD = AC.Aero.CL.tot - sqrt(AC.Aero.CD.ind .* (pi*AC.Geometry.AR*AC.Aero.CD.osw));

% Table for Simulink
coef = 'CD';

% Stability Table
AC.Aero.(coef).tableStab = AC.Aero.(coef).(AC.Aero.stabDragFields{1});
for indxSurf = 2:length(AC.Aero.stabDragFields)
    AC.Aero.(coef).tableStab = cat(AC.Aero.tableDim, AC.Aero.(coef).tableStab, AC.Aero.(coef).(AC.Aero.stabDragFields{indxSurf}));
end
AC.Aero.(coef).tableSelStab = 1:size(AC.Aero.(coef).tableStab, AC.Aero.tableDim); % Table select for choosing active fields

% Control Table
AC.Aero.(coef).tableCntrl = AC.Aero.(coef).(AC.Aero.cntrlFields{1});
for indxSurf = 2:length(AC.Aero.cntrlFields)
    AC.Aero.(coef).tableCntrl = cat(AC.Aero.tableDim, AC.Aero.(coef).tableCntrl, AC.Aero.(coef).(AC.Aero.cntrlFields{indxSurf}));
end
AC.Aero.(coef).tableSelCntrl = 1:size(AC.Aero.(coef).tableCntrl, AC.Aero.tableDim); % Table select for choosing active fields



%% Side Force coefficient
AC.Aero.CY.tot = [-0.01355 -0.00648 -1e-05 0.00646 0.01354;-0.00506 -0.0024 0 0.00239 0.00505;-0.00173 -0.00079 0 0.00079 0.00173;-0.00018 -4e-05 0 4e-05 0.00018;0.00064 0.00035 0 -0.00035 -0.00064;0.0011 0.00058 0 -0.00058 -0.0011;0.00162 0.00083 0 -0.00083 -0.00162;0.0018 0.00092 0 -0.00092 -0.0018;0.00192 0.00098 0 -0.00098 -0.00192];
AC.Aero.CY.alpha = [0.005893 0.002803 -1e-06 -0.002804 -0.005894;0.002845 0.001404 -1e-06 -0.001406 -0.002847;0.002217 0.001113 -1e-06 -0.001115 -0.002219;0.00202 0.00102 -1e-06 -0.001021 -0.002022;0.00192 0.00097 0 -0.000971 -0.001921;0.001846 0.000933 0 -0.000934 -0.001847;0.001704 0.000861 0 -0.000862 -0.001704;0.0016 0.000809 0 -0.000809 -0.0016;0.001471 0.000745 0 -0.000745 -0.001471];
AC.Aero.CY.beta = [-0.125106 -0.121356 -0.120187 -0.121353 -0.1251;-0.119896 -0.118391 -0.117924 -0.11839 -0.119893;-0.116881 -0.116276 -0.116094 -0.116276 -0.11688;-0.114954 -0.114781 -0.114736 -0.114781 -0.114953;-0.113641 -0.113702 -0.11373 -0.113702 -0.11364;-0.112705 -0.112902 -0.112975 -0.112902 -0.112704;-0.111272 -0.111632 -0.111755 -0.111631 -0.111272;-0.110495 -0.110919 -0.111063 -0.110919 -0.110495;-0.109723 -0.110194 -0.110354 -0.110194 -0.109723];
AC.Aero.CY.pHat = [0.398745 0.393819 0.392204 0.393818 0.398744;0.274592 0.271173 0.270048 0.271173 0.274592;0.19943 0.196894 0.196059 0.196894 0.19943;0.150696 0.148727 0.148078 0.148727 0.150696;0.117347 0.115764 0.115242 0.115764 0.117347;0.093537 0.092227 0.091796 0.092227 0.093537;0.057082 0.056191 0.055897 0.056191 0.057082;0.037331 0.036666 0.036446 0.036666 0.037331;0.017733 0.017292 0.017146 0.017292 0.017733];
AC.Aero.CY.qHat = [-0.033063 -0.015219 -2.8e-05 0.015161 0.033002;-0.003889 -0.001371 -1.4e-05 0.001343 0.00386;0.007785 0.004212 -7e-06 -0.004227 -0.0078;0.013378 0.006893 -4e-06 -0.006902 -0.013387;0.016365 0.008326 -3e-06 -0.008332 -0.016371;0.018089 0.009154 -2e-06 -0.009157 -0.018093;0.020068 0.010104 -1e-06 -0.010105 -0.020069;0.020803 0.010457 0 -0.010458 -0.020804;0.021294 0.010693 0 -0.010693 -0.021295];
AC.Aero.CY.rHat = [0.016424 0.022599 0.024595 0.022599 0.016424;0.078496 0.081874 0.082979 0.081874 0.078496;0.102193 0.10458 0.105366 0.10458 0.102194;0.112694 0.11464 0.115283 0.11464 0.112694;0.117796 0.119519 0.120091 0.119519 0.117796;0.12043 0.12203 0.122563 0.12203 0.12043;0.122858 0.124329 0.124819 0.124329 0.122858;0.123371 0.124799 0.125276 0.124799 0.123371;0.123324 0.124729 0.125198 0.124729 0.123324];
AC.Aero.CY.dflapR = [-0.0025783100780887 -0.00269290163711487 -0.00275019741662795 -0.00269290163711487 -0.0025783100780887;-0.00326585943224569 -0.00338045099127186 -0.00338045099127186 -0.00332315521175878 -0.00320856365273261;-0.00360963410932419 -0.00366692988883727 -0.00372422566835035 -0.00366692988883727 -0.0035523383298111;-0.00378152144786343 -0.0038961130068896 -0.0038961130068896 -0.00383881722737652 -0.00372422566835035;-0.00395340878640268 -0.00401070456591576 -0.00401070456591576 -0.00401070456591576 -0.0038961130068896;-0.00401070456591576 -0.00412529612494193 -0.00412529612494193 -0.00406800034542884 -0.00395340878640268;-0.00412529612494193 -0.00423988768396809 -0.00423988768396809 -0.00418259190445501 -0.00406800034542884;-0.00418259190445501 -0.00429718346348117 -0.00429718346348117 -0.00423988768396809 -0.00412529612494193;-0.00429718346348117 -0.00435447924299426 -0.00435447924299426 -0.00429718346348117 -0.00418259190445501];
AC.Aero.CY.dailR = [0 0 0 0 0;-0.000171887338539247 -0.000171887338539247 -0.000171887338539247 -0.000171887338539247 -0.000171887338539247;-0.000229183118052329 -0.000229183118052329 -0.000229183118052329 -0.000229183118052329 -0.000229183118052329;-0.000286478897565412 -0.000286478897565412 -0.000286478897565412 -0.000286478897565412 -0.000286478897565412;-0.000343774677078494 -0.000343774677078494 -0.000343774677078494 -0.000343774677078494 -0.000343774677078494;-0.000343774677078494 -0.000343774677078494 -0.000343774677078494 -0.000343774677078494 -0.000343774677078494;-0.000401070456591576 -0.000401070456591576 -0.000401070456591576 -0.000401070456591576 -0.000401070456591576;-0.000401070456591576 -0.000401070456591576 -0.000401070456591576 -0.000401070456591576 -0.000401070456591576;-0.000401070456591576 -0.000458366236104659 -0.000458366236104659 -0.000458366236104659 -0.000401070456591576];
AC.Aero.CY.dailL = [0 0 0 0 0;0.000171887338539247 0.000171887338539247 0.000171887338539247 0.000171887338539247 0.000171887338539247;0.000229183118052329 0.000229183118052329 0.000229183118052329 0.000229183118052329 0.000229183118052329;0.000286478897565412 0.000286478897565412 0.000286478897565412 0.000286478897565412 0.000286478897565412;0.000343774677078494 0.000343774677078494 0.000343774677078494 0.000343774677078494 0.000343774677078494;0.000343774677078494 0.000343774677078494 0.000343774677078494 0.000343774677078494 0.000343774677078494;0.000401070456591576 0.000401070456591576 0.000401070456591576 0.000401070456591576 0.000401070456591576;0.000401070456591576 0.000401070456591576 0.000401070456591576 0.000401070456591576 0.000401070456591576;0.000401070456591576 0.000458366236104659 0.000458366236104659 0.000458366236104659 0.000401070456591576];
AC.Aero.CY.dflapL = [0.0025783100780887 0.00269290163711487 0.00275019741662795 0.00269290163711487 0.0025783100780887;0.00320856365273261 0.00332315521175878 0.00338045099127186 0.00338045099127186 0.00326585943224569;0.0035523383298111 0.00366692988883727 0.00372422566835035 0.00366692988883727 0.00360963410932419;0.00372422566835035 0.00383881722737652 0.0038961130068896 0.0038961130068896 0.00378152144786343;0.0038961130068896 0.00401070456591576 0.00401070456591576 0.00401070456591576 0.00395340878640268;0.00395340878640268 0.00406800034542884 0.00412529612494193 0.00412529612494193 0.00401070456591576;0.00406800034542884 0.00418259190445501 0.00423988768396809 0.00423988768396809 0.00412529612494193;0.00412529612494193 0.00423988768396809 0.00429718346348117 0.00429718346348117 0.00418259190445501;0.00418259190445501 0.00429718346348117 0.00435447924299426 0.00435447924299426 0.00429718346348117];
AC.Aero.CY.delev = [-5.72957795130823e-05 0 0 0 5.72957795130823e-05;5.72957795130823e-05 0 0 0 -5.72957795130823e-05;5.72957795130823e-05 5.72957795130823e-05 0 -5.72957795130823e-05 -5.72957795130823e-05;5.72957795130823e-05 5.72957795130823e-05 0 -5.72957795130823e-05 -5.72957795130823e-05;0.000114591559026165 5.72957795130823e-05 0 -5.72957795130823e-05 -0.000114591559026165;0.000114591559026165 5.72957795130823e-05 0 -5.72957795130823e-05 -0.000114591559026165;0.000114591559026165 5.72957795130823e-05 0 -5.72957795130823e-05 -0.000114591559026165;0.000114591559026165 5.72957795130823e-05 0 -5.72957795130823e-05 -0.000114591559026165;0.000114591559026165 5.72957795130823e-05 0 -5.72957795130823e-05 -0.000114591559026165];
AC.Aero.CY.drud = [0.096772571597596 0.0992362901166586 0.100038431029842 0.0992362901166586 0.096772571597596;0.0978611914083446 0.100153022588868 0.100897867722538 0.100153022588868 0.0978611914083446;0.0975174167312661 0.0997519521322763 0.100496797265946 0.0997519521322763 0.0975174167312661;0.0969444589361353 0.0991216985576324 0.0998665436913025 0.0991216985576324 0.0969444589361353;0.0963715011410045 0.0985487407625016 0.0992935858961717 0.0985487407625016 0.0963715011410045;0.0959131349048998 0.0980903745263969 0.098835219660067 0.0980903745263969 0.0959131349048998;0.0950536982122036 0.0972309378337007 0.0979757829673708 0.0972309378337007 0.0950536982122036;0.0945953319760989 0.096715275818083 0.097460120951753 0.096715275818083 0.0945953319760989;0.0940223741809681 0.0961996138024652 0.0968871631566222 0.0961996138024652 0.0940223741809681];

% Tables for alphaDot and betaDot (not available from AVL)
AC.Aero.CY.alphaDot = zeros(size(AC.Aero.CY.alpha));
AC.Aero.CY.betaDot = zeros(size(AC.Aero.CY.beta));

% Create a zero term, start with the total and remove the trim conditions
AC.Aero.CY.zero = AC.Aero.CY.tot;
for indxDep = 1:length(depList)
    AC.Aero.CY.zero = AC.Aero.CY.zero - (AC.Aero.CY.(depList{indxDep}) .* AC.Aero.(depList{indxDep}));
end

% Table for Simulink
coef = 'CY';

% Stability Table
AC.Aero.(coef).tableStab = AC.Aero.(coef).(AC.Aero.stabFields{1});
for indxSurf = 2:length(AC.Aero.stabFields)
    AC.Aero.(coef).tableStab = cat(AC.Aero.tableDim, AC.Aero.(coef).tableStab, AC.Aero.(coef).(AC.Aero.stabFields{indxSurf}));
end
AC.Aero.(coef).tableSelStab = 1:size(AC.Aero.(coef).tableStab, AC.Aero.tableDim); % Table select for choosing active fields

% Control Table
AC.Aero.(coef).tableCntrl = AC.Aero.(coef).(AC.Aero.cntrlFields{1});
for indxSurf = 2:length(AC.Aero.cntrlFields)
    AC.Aero.(coef).tableCntrl = cat(AC.Aero.tableDim, AC.Aero.(coef).tableCntrl, AC.Aero.(coef).(AC.Aero.cntrlFields{indxSurf}));
end
AC.Aero.(coef).tableSelCntrl = 1:size(AC.Aero.(coef).tableCntrl, AC.Aero.tableDim); % Table select for choosing active fields


%% Roll moment coefficient
AC.Aero.Cl.tot = [0.02578 0.01276 0 -0.01276 -0.02578;0.01749 0.00867 0 -0.00867 -0.01749;0.01273 0.00631 0 -0.00631 -0.01273;0.00969 0.00481 0 -0.00481 -0.00969;0.00763 0.00378 0 -0.00378 -0.00763;0.00617 0.00306 0 -0.00306 -0.00617;0.00393 0.00195 0 -0.00195 -0.00393;0.00272 0.00134 0 -0.00134 -0.00272;0.00151 0.00075 0 -0.00075 -0.00151];
AC.Aero.Cl.alpha = [0.086269 0.044012 -8e-06 -0.044028 -0.086286;0.090596 0.046079 -4e-06 -0.046087 -0.090604;0.092214 0.046859 -2e-06 -0.046864 -0.092218;0.092966 0.047224 -1e-06 -0.047227 -0.092969;0.093363 0.047416 -1e-06 -0.047418 -0.093365;0.09359 0.047526 -1e-06 -0.047528 -0.093591;0.093848 0.047652 0 -0.047653 -0.093849;0.093943 0.047698 0 -0.047699 -0.093944;0.094007 0.047729 0 -0.04773 -0.094007];
AC.Aero.Cl.beta = [-0.115809 -0.120312 -0.121765 -0.120312 -0.115809;-0.08246 -0.08526 -0.08617 -0.08526 -0.08246;-0.061442 -0.063396 -0.064032 -0.063396 -0.061442;-0.047546 -0.048997 -0.04947 -0.048997 -0.047546;-0.037928 -0.03905 -0.039415 -0.03905 -0.037928;-0.031009 -0.031902 -0.032192 -0.031902 -0.031009;-0.020337 -0.020886 -0.021064 -0.020886 -0.020337;-0.014517 -0.014882 -0.015001 -0.014882 -0.014517;-0.008716 -0.0089 -0.00896 -0.0089 -0.008716];
AC.Aero.Cl.pHat = [-0.35304 -0.358967 -0.36093 -0.358967 -0.35304;-0.373165 -0.378338 -0.38006 -0.378338 -0.373165;-0.381776 -0.38666 -0.388288 -0.38666 -0.381777;-0.386048 -0.390794 -0.392379 -0.390794 -0.386048;-0.388395 -0.393069 -0.394629 -0.393069 -0.388395;-0.389788 -0.394419 -0.395966 -0.394419 -0.389788;-0.391464 -0.396046 -0.397578 -0.396046 -0.391464;-0.392141 -0.396706 -0.398231 -0.396706 -0.392141;-0.392653 -0.397205 -0.398726 -0.397205 -0.392653];
AC.Aero.Cl.qHat = [0.148867 0.074459 3e-06 -0.074452 -0.14886;0.144517 0.072479 0 -0.072478 -0.144516;0.143707 0.072117 0 -0.072118 -0.143708;0.143629 0.072091 -1e-06 -0.072092 -0.14363;0.14372 0.07214 -1e-06 -0.072141 -0.143721;0.143839 0.0722 -1e-06 -0.072202 -0.143841;0.144086 0.072323 -1e-06 -0.072325 -0.144088;0.144243 0.0724 -1e-06 -0.072402 -0.144245;0.144408 0.072482 -1e-06 -0.072483 -0.14441];
AC.Aero.Cl.rHat = [0.254314 0.251264 0.250267 0.251264 0.254313;0.176821 0.174786 0.174118 0.174786 0.17682;0.130327 0.128835 0.128344 0.128835 0.130327;0.100168 0.099018 0.098639 0.099018 0.100168;0.079484 0.078566 0.078263 0.078566 0.079484;0.064681 0.063928 0.06368 0.063928 0.064681;0.041943 0.041444 0.041279 0.041444 0.041943;0.029579 0.029219 0.0291 0.029219 0.029579;0.017277 0.017054 0.016981 0.017054 0.017277];
AC.Aero.Cl.dflapR = [-0.036898482006425 -0.0402789329976969 -0.0428572430757856 -0.0446907080202042 -0.0456647362719266;-0.0391330174074352 -0.042456172619194 -0.0450917784767958 -0.0470398349802406 -0.0481284547909892;-0.0399924541001315 -0.0433156093118902 -0.0460085109490051 -0.0479565674524499 -0.0491024830427116;-0.0404508203362361 -0.0437739755479949 -0.0464668771851098 -0.0484149336885546 -0.0495608492788162;-0.0406800034542885 -0.0440031586660472 -0.0466960603031621 -0.0486441168066069 -0.0498473281763816;-0.0407945950133146 -0.0441177502250734 -0.0468106518621883 -0.0488160041451461 -0.0499619197354078;-0.0409664823518539 -0.0442896375636126 -0.0469825392007275 -0.0489305957041723 -0.050133807073947;-0.0410237781313669 -0.0443469333431257 -0.0470398349802406 -0.0489878914836854 -0.0501911028534601;-0.04108107391088 -0.0444042291226388 -0.0470971307597537 -0.0490451872631985 -0.0502483986329732];
AC.Aero.Cl.dailR = [-0.0929337543702195 -0.0980903745263969 -0.101470825517669 -0.102960515785009 -0.102502149548904;-0.09814767030591 -0.103246994682574 -0.106570149894333 -0.108174431720699 -0.107945248602647;-0.100267614147894 -0.105309642745045 -0.108690093736317 -0.110294375562683 -0.110122488224144;-0.10129893817913 -0.106283670996768 -0.10966412198804 -0.111325699593919 -0.11115381225538;-0.101814600194747 -0.106799333012385 -0.110179784003657 -0.111841361609537 -0.111726770050511;-0.102101079092313 -0.107085811909951 -0.110466262901223 -0.112127840507102 -0.112013248948076;-0.102444853769391 -0.107429586587029 -0.110810037578301 -0.112471615184181 -0.112357023625154;-0.102559445328417 -0.107544178146056 -0.110924629137327 -0.112586206743207 -0.112528910963694;-0.10261674110793 -0.107601473925569 -0.11098192491684 -0.11264350252272 -0.112586206743207];
AC.Aero.Cl.dailL = [0.102502149548904 0.102960515785009 0.101470825517669 0.0980903745263969 0.0929337543702195;0.107945248602647 0.108174431720699 0.106570149894333 0.103246994682574 0.09814767030591;0.110122488224144 0.110294375562683 0.108690093736317 0.105309642745045 0.100267614147894;0.11115381225538 0.111325699593919 0.10966412198804 0.106283670996768 0.10129893817913;0.111726770050511 0.111841361609537 0.110179784003657 0.106799333012385 0.101814600194747;0.112013248948076 0.112127840507102 0.110466262901223 0.107085811909951 0.102101079092313;0.112357023625154 0.112471615184181 0.110810037578301 0.107429586587029 0.102444853769391;0.112528910963694 0.112586206743207 0.110924629137327 0.107544178146056 0.102559445328417;0.112586206743207 0.11264350252272 0.11098192491684 0.107601473925569 0.10261674110793];
AC.Aero.Cl.dflapL = [0.0456647362719266 0.0446907080202042 0.0428572430757856 0.0402789329976969 0.036898482006425;0.0481284547909892 0.0470398349802406 0.0450917784767958 0.042456172619194 0.0391330174074352;0.0491024830427116 0.0479565674524499 0.0460085109490051 0.0433156093118902 0.0399924541001315;0.0495608492788162 0.0484149336885546 0.0464668771851098 0.0437739755479949 0.0404508203362361;0.0498473281763816 0.0486441168066069 0.0466960603031621 0.0440031586660472 0.0406800034542885;0.0499619197354078 0.0488160041451461 0.0468106518621883 0.0441177502250734 0.0407945950133146;0.050133807073947 0.0489305957041723 0.0469825392007275 0.0442896375636126 0.0409664823518539;0.0501911028534601 0.0489878914836854 0.0470398349802406 0.0443469333431257 0.0410237781313669;0.0502483986329732 0.0490451872631985 0.0470971307597537 0.0444042291226388 0.04108107391088];
AC.Aero.Cl.delev = [0.00653171886449139 0.00332315521175878 0 -0.00332315521175878 -0.00653171886449139;0.00658901464400447 0.00332315521175878 0 -0.00332315521175878 -0.00658901464400447;0.00658901464400447 0.00338045099127186 0 -0.00338045099127186 -0.00658901464400447;0.00658901464400447 0.00338045099127186 0 -0.00338045099127186 -0.00658901464400447;0.00658901464400447 0.00338045099127186 0 -0.00338045099127186 -0.00658901464400447;0.00664631042351755 0.00338045099127186 0 -0.00338045099127186 -0.00664631042351755;0.00664631042351755 0.00338045099127186 0 -0.00338045099127186 -0.00664631042351755;0.00664631042351755 0.00338045099127186 0 -0.00338045099127186 -0.00664631042351755;0.00664631042351755 0.00338045099127186 0 -0.00338045099127186 -0.00664631042351755];
AC.Aero.Cl.drud = [-0.000229183118052329 -0.000171887338539247 -0.000171887338539247 -0.000171887338539247 -0.000229183118052329;0.000286478897565412 0.000343774677078494 0.000343774677078494 0.000343774677078494 0.000286478897565412;0.000630253574643905 0.000630253574643905 0.000630253574643905 0.000630253574643905 0.000630253574643905;0.000802140913183152 0.000802140913183152 0.000859436692696235 0.000802140913183152 0.000802140913183152;0.000916732472209317 0.000974028251722399 0.000974028251722399 0.000974028251722399 0.000916732472209317;0.00103132403123548 0.00103132403123548 0.00103132403123548 0.00103132403123548 0.00103132403123548;0.00114591559026165 0.00120321136977473 0.00120321136977473 0.00120321136977473 0.00114591559026165;0.00120321136977473 0.00126050714928781 0.00126050714928781 0.00126050714928781 0.00120321136977473;0.00131780292880089 0.00131780292880089 0.00131780292880089 0.00131780292880089 0.00131780292880089];

% Tables for alphaDot and betaDot (not available from AVL)
AC.Aero.Cl.alphaDot = zeros(size(AC.Aero.Cl.alpha));
AC.Aero.Cl.betaDot = zeros(size(AC.Aero.Cl.beta));

% Create a zero term, start with the total and remove the trim conditions
AC.Aero.Cl.zero = AC.Aero.Cl.tot;
for indxDep = 1:length(depList)
    AC.Aero.Cl.zero = AC.Aero.Cl.zero - (AC.Aero.Cl.(depList{indxDep}) .* AC.Aero.(depList{indxDep}));
end

% Table for Simulink
coef = 'Cl';

% Stability Table
AC.Aero.(coef).tableStab = AC.Aero.(coef).(AC.Aero.stabFields{1});
for indxSurf = 2:length(AC.Aero.stabFields)
    AC.Aero.(coef).tableStab = cat(AC.Aero.tableDim, AC.Aero.(coef).tableStab, AC.Aero.(coef).(AC.Aero.stabFields{indxSurf}));
end
AC.Aero.(coef).tableSelStab = 1:size(AC.Aero.(coef).tableStab, AC.Aero.tableDim); % Table select for choosing active fields

% Control Table
AC.Aero.(coef).tableCntrl = AC.Aero.(coef).(AC.Aero.cntrlFields{1});
for indxSurf = 2:length(AC.Aero.cntrlFields)
    AC.Aero.(coef).tableCntrl = cat(AC.Aero.tableDim, AC.Aero.(coef).tableCntrl, AC.Aero.(coef).(AC.Aero.cntrlFields{indxSurf}));
end
AC.Aero.(coef).tableSelCntrl = 1:size(AC.Aero.(coef).tableCntrl, AC.Aero.tableDim); % Table select for choosing active fields


%% Pitch moment coefficient
AC.Aero.Cm.tot = [0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0;0 0 0 0 0];
AC.Aero.Cm.alpha = [-1.779798 -1.814713 -1.826516 -1.814712 -1.779796;-1.694829 -1.730872 -1.743013 -1.730871 -1.694829;-1.648746 -1.684902 -1.697075 -1.684902 -1.648746;-1.620156 -1.656261 -1.668415 -1.656261 -1.620156;-1.600995 -1.637026 -1.649155 -1.637026 -1.600995;-1.587462 -1.623425 -1.635532 -1.623425 -1.587462;-1.566914 -1.602756 -1.614823 -1.602755 -1.566914;-1.555839 -1.591608 -1.603651 -1.591608 -1.555839;-1.544872 -1.580565 -1.592584 -1.580566 -1.544872];
AC.Aero.Cm.beta = [-0.017982 -0.009542 1.3e-05 0.009568 0.018009;-0.031265 -0.015774 6e-06 0.015786 0.031278;-0.036563 -0.018278 3e-06 0.018285 0.03657;-0.039102 -0.019482 2e-06 0.019485 0.039106;-0.040461 -0.020126 1e-06 0.020129 0.040463;-0.041247 -0.0205 1e-06 0.020501 0.041249;-0.042156 -0.020931 0 0.020932 0.042157;-0.042499 -0.021094 0 0.021095 0.042499;-0.042733 -0.021205 0 0.021206 0.042733];
AC.Aero.Cm.pHat = [0.000649 0.000532 -1.3e-05 -0.000559 -0.000677;0.003541 0.001784 -7e-06 -0.001799 -0.003556;0.003231 0.001591 -5e-06 -0.001601 -0.003241;0.002479 0.001207 -4e-06 -0.001214 -0.002486;0.00177 0.000853 -3e-06 -0.000859 -0.001775;0.001183 0.000563 -2e-06 -0.000567 -0.001188;0.000177 6.7e-05 -2e-06 -7e-05 -0.000181;-0.000413 -0.000224 -1e-06 0.000222 0.000411;-0.001026 -0.000525 -1e-06 0.000523 0.001024];
AC.Aero.Cm.qHat = [-10.170477 -10.321211 -10.371205 -10.321214 -10.170481;-10.494628 -10.63109 -10.676561 -10.631091 -10.494631;-10.629391 -10.7608 -10.804648 -10.7608 -10.62939;-10.696152 -10.825261 -10.86837 -10.825263 -10.696151;-10.733193 -10.861104 -10.903824 -10.861105 -10.733191;-10.755507 -10.882729 -10.925227 -10.882729 -10.755507;-10.783156 -10.909584 -10.951828 -10.909586 -10.783156;-10.794898 -10.921021 -10.963164 -10.921022 -10.794898;-10.804319 -10.930225 -10.972296 -10.930225 -10.804319];
AC.Aero.Cm.rHat = [0.018803 0.010093 -1.1e-05 -0.010116 -0.018826;0.033158 0.016939 -6e-06 -0.01695 -0.03317;0.039168 0.019818 -3e-06 -0.019824 -0.039174;0.042093 0.021221 -2e-06 -0.021225 -0.042097;0.043665 0.021975 -1e-06 -0.021978 -0.043667;0.044571 0.022411 -1e-06 -0.022412 -0.044573;0.045606 0.022907 0 -0.022908 -0.045606;0.045984 0.023088 0 -0.023089 -0.045984;0.046229 0.023206 0 -0.023206 -0.046229];
AC.Aero.Cm.dflapR = [-0.0202827059476311 -0.0195951565934742 -0.0186211283417518 -0.0173606211924639 -0.0159282267046369;-0.0193086776959087 -0.0186784241212648 -0.0177616916490555 -0.0166157760587939 -0.015297973129993;-0.0185638325622387 -0.0179908747671079 -0.0170741422948985 -0.01598552248415 -0.0146677195553491;-0.018105466326134 -0.0174752127514901 -0.0166157760587939 -0.0155271562480453 -0.0142666490987575;-0.0177043958695424 -0.0171314380744116 -0.0162720013817154 -0.0151833815709668 -0.013922874421679;-0.017417916971977 -0.0168449591768462 -0.01598552248415 -0.0149541984529145 -0.0136363955241136;-0.0170168465153855 -0.0164438887202546 -0.0155844520275584 -0.0144958322168098 -0.013235325067522;-0.0167876633973331 -0.0161574098226892 -0.0153552689095061 -0.0142666490987575 -0.0130061419494697;-0.0165011844997677 -0.0159282267046369 -0.0151260857914537 -0.0140374659807052 -0.0127769588314174];
AC.Aero.Cm.dailR = [-0.156417478070715 -0.159511450164421 -0.159740633282474 -0.157105027424872 -0.151719224150642;-0.163178380053258 -0.165928577469886 -0.166043169028913 -0.163464858950824 -0.158308238794646;-0.165527507013295 -0.16822040865041 -0.168277704429923 -0.165756690131347 -0.16060006997517;-0.166501535265017 -0.169137141122619 -0.169194436902132 -0.166616126824043 -0.161574098226892;-0.166902605721609 -0.169538211579211 -0.169595507358724 -0.167017197280635 -0.161975168683484;-0.167074493060148 -0.16971009891775 -0.16971009891775 -0.167189084619174 -0.162147056022023;-0.167131788839661 -0.169767394697263 -0.169767394697263 -0.167246380398687 -0.162204351801536;-0.167074493060148 -0.16971009891775 -0.16971009891775 -0.167189084619174 -0.162147056022023;-0.166959901501122 -0.169538211579211 -0.169595507358724 -0.167017197280635 -0.162032464462997];
AC.Aero.Cm.dailL = [-0.151719224150642 -0.157105027424872 -0.159740633282474 -0.159511450164421 -0.156417478070715;-0.158308238794646 -0.163464858950824 -0.166043169028913 -0.165928577469886 -0.163178380053258;-0.16060006997517 -0.165756690131347 -0.168277704429923 -0.16822040865041 -0.165527507013295;-0.161574098226892 -0.166616126824043 -0.169194436902132 -0.169137141122619 -0.166501535265017;-0.161975168683484 -0.167017197280635 -0.169595507358724 -0.169538211579211 -0.166902605721609;-0.162147056022023 -0.167189084619174 -0.16971009891775 -0.16971009891775 -0.167074493060148;-0.162204351801536 -0.167246380398687 -0.169767394697263 -0.169767394697263 -0.167131788839661;-0.162147056022023 -0.167189084619174 -0.16971009891775 -0.16971009891775 -0.167074493060148;-0.162032464462997 -0.167017197280635 -0.169595507358724 -0.169538211579211 -0.166959901501122];
AC.Aero.Cm.dflapL = [-0.0159282267046369 -0.0173606211924639 -0.0186211283417518 -0.0195951565934742 -0.0202827059476311;-0.015297973129993 -0.0166157760587939 -0.0177616916490555 -0.0186784241212648 -0.0193086776959087;-0.0146677195553491 -0.01598552248415 -0.0170741422948985 -0.0179908747671079 -0.0185638325622387;-0.0142666490987575 -0.0155271562480453 -0.0166157760587939 -0.0174752127514901 -0.0180481705466209;-0.013922874421679 -0.0151833815709668 -0.0162720013817154 -0.0171314380744116 -0.0177043958695424;-0.0136363955241136 -0.0148969026734014 -0.01598552248415 -0.0168449591768462 -0.017417916971977;-0.013235325067522 -0.0144958322168098 -0.0155844520275584 -0.0164438887202546 -0.0170168465153855;-0.0130061419494697 -0.0142666490987575 -0.0153552689095061 -0.0161574098226892 -0.0167876633973331;-0.0127769588314174 -0.0140374659807052 -0.0151260857914537 -0.0159282267046369 -0.0165011844997677];
AC.Aero.Cm.delev = [-1.12036167259881 -1.15250460490565 -1.16327621145411 -1.15250460490565 -1.12036167259881;-1.18407457941736 -1.21426945522075 -1.22441080819457 -1.21426945522075 -1.18407457941736;-1.2100868633163 -1.23965148554505 -1.24956365540081 -1.23965148554505 -1.2100868633163;-1.22257734325015 -1.25185548658134 -1.26171036065759 -1.25185548658134 -1.22257734325015;-1.22928094945318 -1.25838720544583 -1.26818478374256 -1.25838720544583 -1.22928094945318;-1.23317706246007 -1.26216872689369 -1.27196630519043 -1.26216872689369 -1.23317706246007;-1.23764613326209 -1.2665805019162 -1.27632078443342 -1.2665805019162 -1.23764613326209;-1.23936500664748 -1.26824207952208 -1.2779823620393 -1.26824207952208 -1.23936500664748;-1.24056821801726 -1.26944529089185 -1.27918557340908 -1.26944529089185 -1.24056821801726];
AC.Aero.Cm.drud = [0.0271009037096879 0.0138082828626528 0 -0.0138082828626528 -0.0271009037096879;0.0281322277409234 0.0142666490987575 0 -0.0142666490987575 -0.0281322277409234;0.028533298197515 0.0144958322168098 0 -0.0144958322168098 -0.028533298197515;0.0287051855360542 0.0145531279963229 0 -0.0145531279963229 -0.0287051855360542;0.0288197770950804 0.014610423775836 0 -0.014610423775836 -0.0288197770950804;0.0288770728745935 0.0146677195553491 0 -0.0146677195553491 -0.0288770728745935;0.0289343686541066 0.0146677195553491 0 -0.0146677195553491 -0.0289343686541066;0.0289343686541066 0.0147250153348622 0 -0.0147250153348622 -0.0289343686541066;0.0289916644336197 0.0147250153348622 0 -0.0147250153348622 -0.0289916644336197];

% Tables for alphaDot and betaDot (not available from AVL)
AC.Aero.Cm.alphaDot = zeros(size(AC.Aero.Cm.alpha));
AC.Aero.Cm.betaDot = zeros(size(AC.Aero.Cm.beta));

% Create a zero term, start with the total and remove the trim conditions
AC.Aero.Cm.zero = AC.Aero.Cm.tot;
for indxDep = 1:length(depList)
    AC.Aero.Cm.zero = AC.Aero.Cm.zero - (AC.Aero.Cm.(depList{indxDep}) .* AC.Aero.(depList{indxDep}));
end

% Table for Simulink
coef = 'Cm';

% Stability Table
AC.Aero.(coef).tableStab = AC.Aero.(coef).(AC.Aero.stabFields{1});
for indxSurf = 2:length(AC.Aero.stabFields)
    AC.Aero.(coef).tableStab = cat(AC.Aero.tableDim, AC.Aero.(coef).tableStab, AC.Aero.(coef).(AC.Aero.stabFields{indxSurf}));
end
AC.Aero.(coef).tableSelStab = 1:size(AC.Aero.(coef).tableStab, AC.Aero.tableDim); % Table select for choosing active fields

% Control Table
AC.Aero.(coef).tableCntrl = AC.Aero.(coef).(AC.Aero.cntrlFields{1});
for indxSurf = 2:length(AC.Aero.cntrlFields)
    AC.Aero.(coef).tableCntrl = cat(AC.Aero.tableDim, AC.Aero.(coef).tableCntrl, AC.Aero.(coef).(AC.Aero.cntrlFields{indxSurf}));
end
AC.Aero.(coef).tableSelCntrl = 1:size(AC.Aero.(coef).tableCntrl, AC.Aero.tableDim); % Table select for choosing active fields


%% Yaw moment coefficient
AC.Aero.Cn.tot = [0.0082 0.00394 0 -0.00394 -0.0082;0.00368 0.00178 0 -0.00178 -0.00368;0.00193 0.00093 0 -0.00093 -0.00193;0.00111 0.00054 0 -0.00054 -0.00111;0.00069 0.00033 0 -0.00033 -0.00069;0.00045 0.00022 0 -0.00022 -0.00045;0.00018 9e-05 0 -9e-05 -0.00018;9e-05 4e-05 0 -4e-05 -9e-05;3e-05 1e-05 0 -1e-05 -3e-05];
AC.Aero.Cn.alpha = [-0.057783 -0.028541 -2.8e-05 0.028486 0.057728;-0.038587 -0.01913 -1.9e-05 0.019091 0.038549;-0.028182 -0.013988 -1.4e-05 0.01396 0.028154;-0.021678 -0.010766 -1.1e-05 0.010744 0.021656;-0.017282 -0.008585 -9e-06 0.008568 0.017264;-0.014153 -0.007032 -7e-06 0.007018 0.014139;-0.009356 -0.004651 -5e-06 0.004641 0.009347;-0.006744 -0.003353 -3e-06 0.003347 0.006738;-0.004136 -0.002058 -2e-06 0.002055 0.004132];
AC.Aero.Cn.beta = [0.101411 0.099185 0.098474 0.099185 0.101411;0.076755 0.075719 0.075386 0.075719 0.076755;0.066169 0.065592 0.065406 0.065592 0.066169;0.060831 0.060473 0.060357 0.060473 0.060831;0.057833 0.057592 0.057515 0.057592 0.057833;0.05601 0.055838 0.055783 0.055838 0.05601;0.053722 0.053635 0.053606 0.053635 0.053722;0.052736 0.052682 0.052664 0.052682 0.052736;0.051933 0.051904 0.051895 0.051904 0.051933];
AC.Aero.Cn.pHat = [-0.10702 -0.105062 -0.104429 -0.105062 -0.107019;-0.068572 -0.067498 -0.067147 -0.067498 -0.068572;-0.047987 -0.047261 -0.047023 -0.047261 -0.047987;-0.035364 -0.034822 -0.034644 -0.034822 -0.035364;-0.026975 -0.026546 -0.026404 -0.026546 -0.026975;-0.021086 -0.020731 -0.020614 -0.020731 -0.021086;-0.0122 -0.011953 -0.011871 -0.011953 -0.0122;-0.007438 -0.007247 -0.007184 -0.007247 -0.007438;-0.002742 -0.002605 -0.00256 -0.002605 -0.002742];
AC.Aero.Cn.qHat = [-0.025515 -0.012922 3e-06 0.012928 0.025523;-0.026288 -0.013149 -1e-06 0.013148 0.026287;-0.024502 -0.012214 -2e-06 0.01221 0.024499;-0.02246 -0.011184 -2e-06 0.011179 0.022456;-0.020652 -0.01028 -2e-06 0.010276 0.020647;-0.019148 -0.009533 -2e-06 0.00953 0.019144;-0.01649 -0.008218 -1e-06 0.008215 0.016487;-0.014862 -0.007415 -1e-06 0.007413 0.01486;-0.01311 -0.006553 -1e-06 0.006552 0.013109];
AC.Aero.Cn.rHat = [-0.086824 -0.086817 -0.086821 -0.086817 -0.086824;-0.074928 -0.075242 -0.07535 -0.075242 -0.074928;-0.069087 -0.069543 -0.069698 -0.069543 -0.069087;-0.065849 -0.06638 -0.066558 -0.06638 -0.065849;-0.063886 -0.064458 -0.06465 -0.064458 -0.063886;-0.06261 -0.063209 -0.063409 -0.063209 -0.06261;-0.060863 -0.061494 -0.061706 -0.061494 -0.060863;-0.060022 -0.060668 -0.060883 -0.060668 -0.060022;-0.059262 -0.059919 -0.060138 -0.059919 -0.059262];
AC.Aero.Cn.dflapR = [-0.00114591559026165 -0.00108861981074856 -0.00108861981074856 -0.00108861981074856 -0.00114591559026165;-0.000171887338539247 -0.000114591559026165 -0.000114591559026165 -0.000114591559026165 -0.000171887338539247;0.000401070456591576 0.000458366236104659 0.000458366236104659 0.000458366236104659 0.000401070456591576;0.000802140913183152 0.000802140913183152 0.000859436692696235 0.000802140913183152 0.00074484513367007;0.00103132403123548 0.00108861981074856 0.00108861981074856 0.00103132403123548 0.000974028251722399;0.00120321136977473 0.00126050714928781 0.00126050714928781 0.00120321136977473 0.00114591559026165;0.00148969026734014 0.00148969026734014 0.00148969026734014 0.00148969026734014 0.00143239448782706;0.00160428182636631 0.00166157760587939 0.00166157760587939 0.00160428182636631 0.00160428182636631;0.00177616916490555 0.00177616916490555 0.00177616916490555 0.00177616916490555 0.00171887338539247];
AC.Aero.Cn.dailR = [-0.00578687373082131 -0.00578687373082131 -0.00578687373082131 -0.00572957795130823 -0.00572957795130823;-0.00401070456591576 -0.00395340878640268 -0.00395340878640268 -0.00395340878640268 -0.00395340878640268;-0.00286478897565412 -0.00286478897565412 -0.00286478897565412 -0.00286478897565412 -0.00286478897565412;-0.00217723962149713 -0.00217723962149713 -0.00217723962149713 -0.00211994384198405 -0.00211994384198405;-0.00166157760587939 -0.00166157760587939 -0.00166157760587939 -0.00166157760587939 -0.00166157760587939;-0.00131780292880089 -0.00131780292880089 -0.00131780292880089 -0.00131780292880089 -0.00131780292880089;-0.000802140913183152 -0.000802140913183152 -0.000802140913183152 -0.000802140913183152 -0.000802140913183152;-0.000515662015617741 -0.000515662015617741 -0.000458366236104659 -0.000458366236104659 -0.000458366236104659;-0.000229183118052329 -0.000229183118052329 -0.000171887338539247 -0.000171887338539247 -0.000171887338539247];
AC.Aero.Cn.dailL = [0.00572957795130823 0.00572957795130823 0.00578687373082131 0.00578687373082131 0.00578687373082131;0.00395340878640268 0.00395340878640268 0.00395340878640268 0.00395340878640268 0.00401070456591576;0.00286478897565412 0.00286478897565412 0.00286478897565412 0.00286478897565412 0.00286478897565412;0.00211994384198405 0.00211994384198405 0.00217723962149713 0.00217723962149713 0.00217723962149713;0.00166157760587939 0.00166157760587939 0.00166157760587939 0.00166157760587939 0.00166157760587939;0.00131780292880089 0.00131780292880089 0.00131780292880089 0.00131780292880089 0.00131780292880089;0.000802140913183152 0.000802140913183152 0.000802140913183152 0.000802140913183152 0.000802140913183152;0.000458366236104659 0.000458366236104659 0.000458366236104659 0.000515662015617741 0.000515662015617741;0.000171887338539247 0.000171887338539247 0.000171887338539247 0.000229183118052329 0.000229183118052329];
AC.Aero.Cn.dflapL = [0.00114591559026165 0.00108861981074856 0.00108861981074856 0.00108861981074856 0.00114591559026165;0.000171887338539247 0.000114591559026165 0.000114591559026165 0.000114591559026165 0.000171887338539247;-0.000401070456591576 -0.000458366236104659 -0.000458366236104659 -0.000458366236104659 -0.000401070456591576;-0.00074484513367007 -0.000802140913183152 -0.000859436692696235 -0.000802140913183152 -0.000802140913183152;-0.000974028251722399 -0.00103132403123548 -0.00108861981074856 -0.00108861981074856 -0.00103132403123548;-0.00114591559026165 -0.00120321136977473 -0.00126050714928781 -0.00126050714928781 -0.00120321136977473;-0.00143239448782706 -0.00148969026734014 -0.00148969026734014 -0.00148969026734014 -0.00148969026734014;-0.00160428182636631 -0.00160428182636631 -0.00166157760587939 -0.00166157760587939 -0.00160428182636631;-0.00171887338539247 -0.00177616916490555 -0.00177616916490555 -0.00177616916490555 -0.00177616916490555];
AC.Aero.Cn.delev = [0 0 0 0 0;-5.72957795130823e-05 0 0 0 5.72957795130823e-05;-5.72957795130823e-05 0 0 0 5.72957795130823e-05;-5.72957795130823e-05 -5.72957795130823e-05 0 5.72957795130823e-05 5.72957795130823e-05;-5.72957795130823e-05 -5.72957795130823e-05 0 5.72957795130823e-05 5.72957795130823e-05;-5.72957795130823e-05 -5.72957795130823e-05 0 5.72957795130823e-05 5.72957795130823e-05;-5.72957795130823e-05 -5.72957795130823e-05 0 5.72957795130823e-05 5.72957795130823e-05;-5.72957795130823e-05 -5.72957795130823e-05 0 5.72957795130823e-05 5.72957795130823e-05;-5.72957795130823e-05 -5.72957795130823e-05 0 5.72957795130823e-05 5.72957795130823e-05];
AC.Aero.Cn.drud = [-0.0516807931208003 -0.0529413002700881 -0.0533996665061927 -0.0529413002700881 -0.0516807931208003;-0.0519099762388526 -0.0531131876086273 -0.0535142580652189 -0.0531131876086273 -0.0519099762388526;-0.051508905782261 -0.0527121171520357 -0.0530558918291142 -0.0527121171520357 -0.051508905782261;-0.0511078353256694 -0.0522537509159311 -0.0525975255930096 -0.0522537509159311 -0.0511078353256694;-0.0507067648690779 -0.0518526804593395 -0.0522537509159311 -0.0518526804593395 -0.0507067648690779;-0.0504202859715124 -0.0515662015617741 -0.0519099762388526 -0.0515662015617741 -0.0504202859715124;-0.0499046239558947 -0.0509932437666433 -0.0513943142232348 -0.0509932437666433 -0.0499046239558947;-0.0495608492788162 -0.0507067648690779 -0.0510505395461563 -0.0507067648690779 -0.0495608492788162;-0.0492170746017377 -0.0503629901919994 -0.0507067648690779 -0.0503629901919994 -0.0492170746017377];

% Tables for alphaDot and betaDot (not available from AVL)
AC.Aero.Cn.alphaDot = zeros(size(AC.Aero.Cn.alpha));
AC.Aero.Cn.betaDot = zeros(size(AC.Aero.Cn.beta));

% Create a zero term, start with the total and remove the trim conditions
AC.Aero.Cn.zero = AC.Aero.Cn.tot;
for indxDep = 1:length(depList)
    AC.Aero.Cn.zero = AC.Aero.Cn.zero - (AC.Aero.Cn.(depList{indxDep}) .* AC.Aero.(depList{indxDep}));
end

% Table for Simulink
coef = 'Cn';

% Stability Table
AC.Aero.(coef).tableStab = AC.Aero.(coef).(AC.Aero.stabFields{1});
for indxSurf = 2:length(AC.Aero.stabFields)
    AC.Aero.(coef).tableStab = cat(AC.Aero.tableDim, AC.Aero.(coef).tableStab, AC.Aero.(coef).(AC.Aero.stabFields{indxSurf}));
end
AC.Aero.(coef).tableSelStab = 1:size(AC.Aero.(coef).tableStab, AC.Aero.tableDim); % Table select for choosing active fields

% Control Table
AC.Aero.(coef).tableCntrl = AC.Aero.(coef).(AC.Aero.cntrlFields{1});
for indxSurf = 2:length(AC.Aero.cntrlFields)
    AC.Aero.(coef).tableCntrl = cat(AC.Aero.tableDim, AC.Aero.(coef).tableCntrl, AC.Aero.(coef).(AC.Aero.cntrlFields{indxSurf}));
end
AC.Aero.(coef).tableSelCntrl = 1:size(AC.Aero.(coef).tableCntrl, AC.Aero.tableDim); % Table select for choosing active fields


%% PROPULSION
%Propulsion force application point (usually propeller hub) [x y z]

AC.Geometry.rProp = [-0.075 0 0]; % [m] Propeller in front of reference point

% %*********************************
% %Using a APC 11 x 8 propeller data
% %**********************************
% % Advance ratio vector
% AC.Prop.J = [0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1];%11x8 prop
% 
% % Coefficient of thrust look-up table CT = CT(J)
% AC.Prop.CT = [0.0947 0.1 0.0974 0.088 0.0763 0.0632 0.0461 0.0301 0.00789 -0.0171 -0.0382]; %11x8 Prop
% 
% % Coefficient of power look-up table CP = CP(J)
% AC.Prop.CP = [0.0447 0.0476 0.0494 0.05 0.0494 0.0482 0.0424 0.0318 0.0176 0.0047 -0.01]; %11x8Prop
% %Motor_cal data, old data set
% AC.Prop.Throttle = [0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 0.95 1.0];
% AC.Prop.Power = [0 0.2 0.4 1.3 3.1 6.1 10.4 16.4 24.2 34 45.9 60.1 76.6 95.7 117.3 141.4 168.1 196.7 228 261.4 296.6];
% Sea-level pressure and temperature at which the data above is given
%  pSL = 102300; % Pa
% TSL = 291.15; % deg K

% Thrust alignment orientation, radians
AC.Prop.Angles = [0 0 -3]/180*pi;

% Using an APC 12 x 6E propeller, EFlite Power 25 motor
% Coefficient of thrust polynomial model 
% AEM wind tunnel test data Jan 2011
AC.Prop.CT = [-0.4314 1.08 -0.896 0.1089 0.0604 ];

% Coefficient of power polynomial model 
% AEM wind tunnel test data Jan 2011
AC.Prop.CP = [0.5054 -0.5304 0.0412 0.01664 0.0223];

% Propeller radius %[m] APC 12 x 6E propeller
AC.Prop.Radius = 0.1524;

% Motor polynomial model. Input throttle, output power in watts
% EFlite Power 25, AEM wind tunnel test data Jan 2011
% Castle Creations ICE Lite 50 used to collect motor data
AC.Prop.Power = [174.46 70.135 -4.39];

AC.Prop.ThrottleOutputLimit.Upper = 400;
AC.Prop.ThrottleOutputLimit.Lower = 0;
AC.Prop.OmegaSaturation.Upper = 1256; % 12,000 RPM
AC.Prop.OmegaSaturation.Lower = 1;

% Electric motor and propeller combine moment of inertia
AC.Prop.Jmp = 0.00012991;  % [kg*m^2] From experimental measurement (not updated with Jan 2011 data)

%% Configure Actuators and Initial Conditions
d2r = pi/180; % Degrees to Radians conversion

% Select Effector Variant Type
AC.Sim.Effectors = 2;

%Elevator
AC.Actuator.elevator.BW = 8;    % [Hz]
AC.Actuator.elevator.RateLim = 150*d2r;   % [rad/s]
AC.Actuator.elevator.PosLim = 25*d2r;  % [rad]
AC.Actuator.elevator.NegLim = -25*d2r; %[rad]

%Ailerons
AC.Actuator.l_aileron.BW = 8;    % [Hz]
AC.Actuator.l_aileron.RateLim = 150*d2r;   % [rad/s]
AC.Actuator.l_aileron.PosLim = 25*d2r;  % [rad]
AC.Actuator.l_aileron.NegLim = -25*d2r; %[rad]

AC.Actuator.r_aileron.BW = 8;    % [Hz]
AC.Actuator.r_aileron.RateLim = 150*d2r;   % [rad/s]
AC.Actuator.r_aileron.PosLim = 25*d2r;  % [rad]
AC.Actuator.r_aileron.NegLim = -25*d2r; %[rad]

%Rudder
AC.Actuator.rudder.BW = 8;    % [Hz]
AC.Actuator.rudder.RateLim = 150*d2r;   % [rad/s]
AC.Actuator.rudder.PosLim = 25*d2r;  % [rad]
AC.Actuator.rudder.NegLim = -25*d2r; %[rad]

%Flaps
AC.Actuator.l_flap.BW = 8;    % [Hz]
AC.Actuator.l_flap.RateLim = 150*d2r;   % [rad/s]
AC.Actuator.l_flap.PosLim = 25*d2r;  % [rad]
AC.Actuator.l_flap.NegLim = -25*d2r; %[rad]

AC.Actuator.r_flap.BW = 8;    % [Hz]
AC.Actuator.r_flap.RateLim = 150*d2r;   % [rad/s]
AC.Actuator.r_flap.PosLim = 25*d2r;  % [rad]
AC.Actuator.r_flap.NegLim = -25*d2r; %[rad]

%Throttle
AC.Actuator.throttle.PosLim = 1;  % [nd]
AC.Actuator.throttle.NegLim = 0; %[nd]


%% Configure Sensor Error Models

% Model Variants
AC.Sim.Sensor.IMU = 2;
AC.Sim.Sensor.GPS = 3;
AC.Sim.Sensor.Airdata = 3;

% Flag to enable noise
AC.Sensors.NoiseOn = 1;

% Gyro Error Model Parameters (meas = scf * (true + noise) + bias)
AC.Sensors.IMU.p_scf = 1; % rad/s
AC.Sensors.IMU.q_scf = 1; % rad/s
AC.Sensors.IMU.r_scf = 1; % rad/s
AC.Sensors.IMU.p_bias = 0; % rad/s
AC.Sensors.IMU.q_bias = 0; % rad/s
AC.Sensors.IMU.r_bias = 0; % rad/s
AC.Sensors.IMU.p_noise = 0.000001; % rad/s
AC.Sensors.IMU.q_noise = 0.000001; % rad/s
AC.Sensors.IMU.r_noise = 0.000001; % rad/s

% Accelerometer Error Model Parameters (meas = scf * (true + noise) + bias)
AC.Sensors.IMU.ax_scf = 1; % m/s^2
AC.Sensors.IMU.ay_scf = 1;  % m/s^2
AC.Sensors.IMU.az_scf = 1;  % m/s^2
AC.Sensors.IMU.ax_bias = 0; % m/s^2
AC.Sensors.IMU.ay_bias = 0;  % m/s^2
AC.Sensors.IMU.az_bias = 0;  % m/s^2
AC.Sensors.IMU.ax_noise = 0.0008; % m/s^2
AC.Sensors.IMU.ay_noise = 0.004;  % m/s^2
AC.Sensors.IMU.az_noise = 0.004;  % m/s^2

% Magnetometer Error Model Parameters (meas = scf * (true + noise) + bias)
AC.Sensors.IMU.hx_scf = 1;   % nT 
AC.Sensors.IMU.hy_scf = 1;   % nT
AC.Sensors.IMU.hz_scf = 1; % nT
AC.Sensors.IMU.hx_bias = 0;   % nT 
AC.Sensors.IMU.hy_bias = 0;   % nT
AC.Sensors.IMU.hz_bias = 0; % nT
AC.Sensors.IMU.hx_noise = 150;   % nT 
AC.Sensors.IMU.hy_noise = 150;   % nT
AC.Sensors.IMU.hz_noise = 80000; % nT


% AirData Error Model Parameters (meas = scf * (true + noise) + bias)
% Dynamic Pressure
AC.Sensors.AirData.Pd_scf = 1; % Kpa, AMS 5812
AC.Sensors.AirData.Pd_bias = 0; % Kpa, AMS 5812
AC.Sensors.AirData.Pd_noise = 0.00000015; % Kpa, AMS 5812

% Static Pressure
AC.Sensors.AirData.Ps_scf = 1; % Kpa, AMS 5812
AC.Sensors.AirData.Ps_bias = 0; % Kpa, AMS 5812
AC.Sensors.AirData.Ps_noise = 0.0000008; % Kpa, AMS 5812

% Indicated Airspeed
AC.Sensors.AirData.ias_scf = 1; % m/s
AC.Sensors.AirData.ias_bias = 0; % m/s
AC.Sensors.AirData.ias_noise = 0.001; % m/s

% Baro Altitude
AC.Sensors.AirData.h_scf = 1; % m
AC.Sensors.AirData.h_bias = 0; % m
AC.Sensors.AirData.h_noise = 0.02; % m

% Angle of Attack
AC.Sensors.AirData.alpha_scf = 1; % rad
AC.Sensors.AirData.alpha_bias = 0; % rad
AC.Sensors.AirData.alpha_noise = 0.0000005; % rad

% Angle of Sideslip
AC.Sensors.AirData.beta_scf = 1; % rad
AC.Sensors.AirData.beta_bias = 0; % rad
AC.Sensors.AirData.beta_noise = 0.0000005; % rad

